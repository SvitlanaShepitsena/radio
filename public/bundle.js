!function t(e,n,i){function o(s,a){if(!n[s]){if(!e[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return o(n?n:t)},c,c.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){"use strict";function i(t){this._node=t,this._projectionType=i.ORTHOGRAPHIC_PROJECTION,this._focalDepth=0,this._near=0,this._far=0,this._requestingUpdate=!1,this._id=t.addComponent(this),this._viewTransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._viewDirty=!1,this._perspectiveDirty=!1,this.setFlat()}var o=t("../core/Commands");i.FRUSTUM_PROJECTION=0,i.PINHOLE_PROJECTION=1,i.ORTHOGRAPHIC_PROJECTION=2,i.prototype.toString=function(){return"Camera"},i.prototype.getValue=function(){return{component:this.toString(),projectionType:this._projectionType,focalDepth:this._focalDepth,near:this._near,far:this._far}},i.prototype.setValue=function(t){return this.toString()===t.component?(this.set(t.projectionType,t.focalDepth,t.near,t.far),!0):!1},i.prototype.set=function(t,e,n,i){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._projectionType=t,this._focalDepth=e,this._near=n,this._far=i},i.prototype.setDepth=function(t){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=i.PINHOLE_PROJECTION,this._focalDepth=t,this._near=0,this._far=0,this},i.prototype.setFrustum=function(t,e){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=i.FRUSTUM_PROJECTION,this._focalDepth=0,this._near=t,this._far=e,this},i.prototype.setFlat=function(){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=i.ORTHOGRAPHIC_PROJECTION,this._focalDepth=0,this._near=0,this._far=0,this},i.prototype.onUpdate=function(){this._requestingUpdate=!1;var t=this._node.getLocation();if(this._node.sendDrawCommand(o.WITH).sendDrawCommand(t),this._perspectiveDirty)switch(this._perspectiveDirty=!1,this._projectionType){case i.FRUSTUM_PROJECTION:this._node.sendDrawCommand(o.FRUSTRUM_PROJECTION),this._node.sendDrawCommand(this._near),this._node.sendDrawCommand(this._far);break;case i.PINHOLE_PROJECTION:this._node.sendDrawCommand(o.PINHOLE_PROJECTION),this._node.sendDrawCommand(this._focalDepth);break;case i.ORTHOGRAPHIC_PROJECTION:this._node.sendDrawCommand(o.ORTHOGRAPHIC_PROJECTION)}this._viewDirty&&(this._viewDirty=!1,this._node.sendDrawCommand(o.CHANGE_VIEW_TRANSFORM),this._node.sendDrawCommand(this._viewTransform[0]),this._node.sendDrawCommand(this._viewTransform[1]),this._node.sendDrawCommand(this._viewTransform[2]),this._node.sendDrawCommand(this._viewTransform[3]),this._node.sendDrawCommand(this._viewTransform[4]),this._node.sendDrawCommand(this._viewTransform[5]),this._node.sendDrawCommand(this._viewTransform[6]),this._node.sendDrawCommand(this._viewTransform[7]),this._node.sendDrawCommand(this._viewTransform[8]),this._node.sendDrawCommand(this._viewTransform[9]),this._node.sendDrawCommand(this._viewTransform[10]),this._node.sendDrawCommand(this._viewTransform[11]),this._node.sendDrawCommand(this._viewTransform[12]),this._node.sendDrawCommand(this._viewTransform[13]),this._node.sendDrawCommand(this._viewTransform[14]),this._node.sendDrawCommand(this._viewTransform[15]))},i.prototype.onTransformChange=function(t){var e=t;this._viewDirty=!0,this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],a=e[5],h=e[6],u=e[7],c=e[8],p=e[9],l=e[10],f=e[11],d=e[12],m=e[13],_=e[14],g=e[15],y=n*a-i*s,v=n*h-o*s,T=n*u-r*s,E=i*h-o*a,b=i*u-r*a,R=o*u-r*h,S=c*m-p*d,C=c*_-l*d,w=c*g-f*d,I=p*_-l*m,O=p*g-f*m,A=l*g-f*_,N=1/(y*A-v*O+T*I+E*w-b*C+R*S);this._viewTransform[0]=(a*A-h*O+u*I)*N,this._viewTransform[1]=(o*O-i*A-r*I)*N,this._viewTransform[2]=(m*R-_*b+g*E)*N,this._viewTransform[3]=(l*b-p*R-f*E)*N,this._viewTransform[4]=(h*w-s*A-u*C)*N,this._viewTransform[5]=(n*A-o*w+r*C)*N,this._viewTransform[6]=(_*T-d*R-g*v)*N,this._viewTransform[7]=(c*R-l*T+f*v)*N,this._viewTransform[8]=(s*O-a*w+u*S)*N,this._viewTransform[9]=(i*w-n*O-r*S)*N,this._viewTransform[10]=(d*b-m*T+g*y)*N,this._viewTransform[11]=(p*T-c*b-f*y)*N,this._viewTransform[12]=(a*C-s*I-h*S)*N,this._viewTransform[13]=(n*I-i*C+o*S)*N,this._viewTransform[14]=(m*v-d*E-_*y)*N,this._viewTransform[15]=(c*E-p*v+l*y)*N},e.exports=i},{"../core/Commands":4}],2:[function(t,e,n){"use strict";function i(){"undefined"!=typeof self&&self.window!==self&&this._enterWorkerMode()}i.prototype._enterWorkerMode=function(){this._workerMode=!0;var t=this;self.addEventListener("message",function(e){t.onMessage(e.data)})},i.prototype.onMessage=null,i.prototype.sendMessage=function(t){this._workerMode?self.postMessage(t):this.onmessage(t)},i.prototype.onmessage=null,i.prototype.postMessage=function(t){return this.onMessage(t)},e.exports=i},{}],3:[function(t,e,n){"use strict";function i(){this._time=0,this._frame=0,this._timerQueue=[],this._updatingIndex=0,this._scale=1,this._scaledTime=this._time}i.prototype.setScale=function(t){return this._scale=t,this},i.prototype.getScale=function(){return this._scale},i.prototype.step=function(t){this._frame++,this._scaledTime=this._scaledTime+(t-this._time)*this._scale,this._time=t;for(var e=0;e<this._timerQueue.length;e++)this._timerQueue[e](this._scaledTime)&&this._timerQueue.splice(e,1);return this},i.prototype.now=function(){return this._scaledTime},i.prototype.getTime=i.prototype.now,i.prototype.getFrame=function(){return this._frame},i.prototype.setTimeout=function(t,e){var n=Array.prototype.slice.call(arguments,2),i=this._time,o=function(o){return o-i>=e?(t.apply(null,n),!0):!1};return this._timerQueue.push(o),o},i.prototype.setInterval=function(t,e){var n=Array.prototype.slice.call(arguments,2),i=this._time,o=function(o){return o-i>=e&&(t.apply(null,n),i=o),!1};return this._timerQueue.push(o),o},i.prototype.clearTimer=function(t){var e=this._timerQueue.indexOf(t);return-1!==e&&this._timerQueue.splice(e,1),this},e.exports=i},{}],4:[function(t,e,n){"use strict";var i={INIT_DOM:0,DOM_RENDER_SIZE:1,CHANGE_TRANSFORM:2,CHANGE_SIZE:3,CHANGE_PROPERTY:4,CHANGE_CONTENT:5,CHANGE_ATTRIBUTE:6,ADD_CLASS:7,REMOVE_CLASS:8,SUBSCRIBE:9,GL_SET_DRAW_OPTIONS:10,GL_AMBIENT_LIGHT:11,GL_LIGHT_POSITION:12,GL_LIGHT_COLOR:13,MATERIAL_INPUT:14,GL_SET_GEOMETRY:15,GL_UNIFORMS:16,GL_BUFFER_DATA:17,GL_CUTOUT_STATE:18,GL_MESH_VISIBILITY:19,GL_REMOVE_MESH:20,PINHOLE_PROJECTION:21,ORTHOGRAPHIC_PROJECTION:22,CHANGE_VIEW_TRANSFORM:23,WITH:24,FRAME:25,ENGINE:26,START:27,STOP:28,TIME:29,TRIGGER:30,NEED_SIZE_FOR:31,DOM:32,READY:33,ALLOW_DEFAULT:34,PREVENT_DEFAULT:35};e.exports=i},{}],5:[function(t,e,n){"use strict";function i(){this._nodes={},this._queue=[]}function o(t,e){e.length=0;var n,i=0,o=t.length;for(n=0;o>n;n++)"/"===t[n]&&(e.push(t.substring(i,n)),i=n+1);return n-i>0&&e.push(t.substring(i,n)),e}var r=t("./Event"),s=t("./Path");i.prototype._setUpdater=function(t){this._updater=t;for(var e in this._nodes)this._nodes[e]._setUpdater(t)},i.prototype.addChildrenToQueue=function(t){for(var e,n=t.getChildren(),i=0,o=n.length;o>i;i++)e=n[i],e&&this._queue.push(e)},i.prototype.next=function(){return this._queue.shift()},i.prototype.breadthFirstNext=function(){var t=this._queue.shift();return t?(this.addChildrenToQueue(t),t):void 0},i.prototype.mount=function(t,e){if(!e)throw new Error("Dispatch: no node passed to mount at: "+t);if(this._nodes[t])throw new Error("Dispatch: there is a node already registered at: "+t);e._setUpdater(this._updater),this._nodes[t]=e;var n=s.parent(t),i=n?this._nodes[n]:e;if(!i)throw new Error("Parent to path: "+t+" doesn't exist at expected path: "+n);var o,r,a=e.getChildren(),h=e.getComponents();if(i.isMounted()&&e._setMounted(!0,t),i.isShown()&&e._setShown(!0),i.isMounted()){for(e._setParent(i),e.onMount&&e.onMount(t),o=0,r=h.length;r>o;o++)h[o]&&h[o].onMount&&h[o].onMount(e,o);for(o=0,r=a.length;r>o;o++)a[o]&&a[o].mount?a[o].mount(t+"/"+o):a[o]&&this.mount(t+"/"+o,a[o])}if(i.isShown())for(e.onShow&&e.onShow(),o=0,r=h.length;r>o;o++)h[o]&&h[o].onShow&&h[o].onShow()},i.prototype.dismount=function(t){var e=this._nodes[t];if(!e)throw new Error("No node registered to path: "+t);var n,i,o=e.getChildren(),r=e.getComponents();if(e.isShown())for(e._setShown(!1),e.onHide&&e.onHide(),n=0,i=r.length;i>n;n++)r[n]&&r[n].onHide&&r[n].onHide();if(e.isMounted()){for(e.onDismount&&e.onDismount(t),n=0,i=o.length;i>n;n++)o[n]&&o[n].dismount?o[n].dismount():o[n]&&this.dismount(t+"/"+n);for(n=0,i=r.length;i>n;n++)r[n]&&r[n].onDismount&&r[n].onDismount();e._setMounted(!1),e._setParent(null)}this._nodes[t]=null},i.prototype.getNode=function(t){return this._nodes[t]},i.prototype.show=function(t){var e=this._nodes[t];if(!e)throw new Error("No node registered to path: "+t);e.onShow&&e.onShow(),this.addChildrenToQueue(e);for(var n;n=this.breadthFirstNext();)this.show(n.getLocation())},i.prototype.hide=function(t){var e=this._nodes[t];if(!e)throw new Error("No node registered to path: "+t);e.onHide&&e.onHide(),this.addChildrenToQueue(e);for(var n;n=this.breadthFirstNext();)this.hide(n.getLocation())},i.prototype.lookupNode=function(t){if(!t)throw new Error("lookupNode must be called with a path");this._queue.length=0;var e=this._queue;o(t,e);for(var n=0,i=e.length;i>n;n++)e[n]=this._nodes[e[n]];return e[e.length-1]},i.prototype.dispatch=function(t,e,n){if(!t)throw new Error("dispatch requires a path as it's first argument");if(!e)throw new Error("dispatch requires an event name as it's second argument");var i=this._nodes[t];if(!i)throw new Error("No node registered at path: "+t);this.addChildrenToQueue(i);for(var o;o=this.breadthFirstNext();)o.onReceive&&o.onReceive(e,n)},i.prototype.dispatchUIEvent=function(t,e,n){if(!t)throw new Error("dispatchUIEvent needs a valid path to dispatch to");if(!e)throw new Error("dispatchUIEvent needs an event name as its second argument");var i;if(r.call(n),i=this.getNode(t)){var o,s,a,h;for(n.node=i;i;){for(i.onReceive&&i.onReceive(e,n),s=i.getComponents(),a=0,h=s.length;h>a;a++)s[a]&&s[a].onReceive&&s[a].onReceive(e,n);if(n.propagationStopped)break;if(o=i.getParent(),o===i)return;i=o}}},e.exports=new i},{"./Event":6,"./Path":9}],6:[function(t,e,n){"use strict";function i(){this.propagationStopped=!1,this.stopPropagation=o}function o(){this.propagationStopped=!0}e.exports=i},{}],7:[function(t,e,n){"use strict";function i(){var t=this;a._setUpdater(this),this._updateQueue=[],this._nextUpdateQueue=[],this._scenes={},this._messages=_,this._inUpdate=!1,this._clock=new o,this._channel=new s,this._channel.onMessage=function(e){t.handleMessage(e)}}var o=t("./Clock"),r=t("./Scene"),s=t("./Channel"),a=t("./Dispatch"),h=t("../renderers/UIManager"),u=t("../renderers/Compositor"),c=t("../render-loops/RequestAnimationFrameLoop"),p=t("./TransformSystem"),l=t("./SizeSystem"),f=t("./Commands"),d=[f.ENGINE,f.START],m=[f.ENGINE,f.STOP],_=[f.TIME,null];i.prototype.init=function(t){return this.compositor=t&&t.compositor||new u,this.renderLoop=t&&t.renderLoop||new c,this.uiManager=new h(this.getChannel(),this.compositor,this.renderLoop),this},i.prototype.setChannel=function(t){return this._channel=t,this},i.prototype.getChannel=function(){return this._channel},i.prototype._update=function(){this._inUpdate=!0;var t,e=this._clock.now(),n=this._nextUpdateQueue,i=this._updateQueue;for(this._messages[1]=e,l.update(),p.onUpdate();n.length;)i.unshift(n.pop());for(;i.length;)t=i.shift(),t&&t.update&&t.update(e),t&&t.onUpdate&&t.onUpdate(e);this._inUpdate=!1},i.prototype.requestUpdate=function(t){if(!t)throw new Error("requestUpdate must be called with a class to be updated");this._inUpdate?this.requestUpdateOnNextTick(t):this._updateQueue.push(t)},i.prototype.requestUpdateOnNextTick=function(t){this._nextUpdateQueue.push(t)},i.prototype.handleMessage=function(t){if(!t)throw new Error("onMessage must be called with an array of messages");for(var e;t.length>0;)switch(e=t.shift()){case f.WITH:this.handleWith(t);break;case f.FRAME:this.handleFrame(t);break;default:throw new Error("received unknown command: "+e)}return this},i.prototype.handleWith=function(t){var e=t.shift(),n=t.shift();switch(n){case f.TRIGGER:var i=t.shift(),o=t.shift();a.dispatchUIEvent(e,i,o);break;default:throw new Error("received unknown command: "+n)}return this},i.prototype.handleFrame=function(t){if(!t)throw new Error("handleFrame must be called with an array of messages");if(!t.length)throw new Error("FRAME must be sent with a time");return this.step(t.shift()),this},i.prototype.step=function(t){if(null==t)throw new Error("step must be called with a time");if(this._clock.step(t),this._update(),this._messages.length)for(this._channel.sendMessage(this._messages);this._messages.length>2;)this._messages.pop();return this},i.prototype.getContext=function(t){if(!t)throw new Error("getContext must be called with a selector");var e=t.indexOf("/");return t=-1===e?t:t.substring(0,e),this._scenes[t]},i.prototype.getClock=function(){return this._clock},i.prototype.message=function(t){return this._messages.push(t),this},i.prototype.createScene=function(t){return t=t||"body",this._scenes[t]&&this._scenes[t].dismount(),this._scenes[t]=new r(t,this),this._scenes[t]},i.prototype.addScene=function(t){var e=t._selector,n=this._scenes[e];return n&&n!==t&&n.dismount(),t.isMounted()||t.mount(),this._scenes[e]=t,this},i.prototype.removeScene=function(t){var e=t._selector,n=this._scenes[e];return n&&n===t&&(t.isMounted()&&t.dismount(),delete this._scenes[e]),this},i.prototype.startRenderLoop=function(){return this._channel.sendMessage(d),this},i.prototype.stopRenderLoop=function(){return this._channel.sendMessage(m),this},i.prototype.startEngine=function(){return console.warn("FamousEngine.startEngine is deprecated! Use FamousEngine.startRenderLoop instead!"),this.startRenderLoop()},i.prototype.stopEngine=function(){return console.warn("FamousEngine.stopEngine is deprecated! Use FamousEngine.stopRenderLoop instead!"),this.stopRenderLoop()},e.exports=new i},{"../render-loops/RequestAnimationFrameLoop":33,"../renderers/Compositor":34,"../renderers/UIManager":36,"./Channel":2,"./Clock":3,"./Commands":4,"./Dispatch":5,"./Scene":11,"./SizeSystem":13,"./TransformSystem":15}],8:[function(t,e,n){"use strict";function i(){this._requestingUpdate=!1,this._inUpdate=!1,this._mounted=!1,this._shown=!1,this._updater=null,this._opacity=1,this._UIEvents=[],this._updateQueue=[],this._nextUpdateQueue=[],this._freedComponentIndicies=[],this._components=[],this._freedChildIndicies=[],this._children=[],this._parent=null,this._id=null,this._transformID=null,this._sizeID=null,this.constructor.INIT_DEFAULT_COMPONENTS&&this._init()}var o=t("./SizeSystem"),r=t("./Dispatch"),s=t("./TransformSystem"),a=t("./Size"),h=t("./Transform");i.RELATIVE_SIZE=0,i.ABSOLUTE_SIZE=1,i.RENDER_SIZE=2,i.DEFAULT_SIZE=0,i.INIT_DEFAULT_COMPONENTS=!0,i.prototype._init=function(){this._transformID=this.addComponent(new h),this._sizeID=this.addComponent(new a)},i.prototype._setParent=function(t){this._parent&&-1!==this._parent.getChildren().indexOf(this)&&this._parent.removeChild(this),this._parent=t},i.prototype._setMounted=function(t,e){this._mounted=t,this._id=e?e:null},i.prototype._setShown=function(t){this._shown=t},i.prototype._setUpdater=function(t){this._updater=t,this._requestingUpdate&&this._updater.requestUpdate(this)},i.prototype.getLocation=function(){return this._id},i.prototype.getId=i.prototype.getLocation,i.prototype.emit=function(t,e){return r.dispatch(this.getLocation(),t,e),this},i.prototype.sendDrawCommand=function(t){return this._updater.message(t),this},i.prototype.getValue=function(){var t=this._children.length,e=this._components.length,n=0,i={location:this.getId(),spec:{location:this.getId(),showState:{mounted:this.isMounted(),shown:this.isShown(),opacity:this.getOpacity()||null},offsets:{mountPoint:[0,0,0],align:[0,0,0],origin:[0,0,0]},vectors:{position:[0,0,0],rotation:[0,0,0,1],scale:[1,1,1]},size:{sizeMode:[0,0,0],proportional:[1,1,1],differential:[0,0,0],absolute:[0,0,0],render:[0,0,0]}},UIEvents:this._UIEvents,components:[],children:[]};if(i.location){var r=s.get(this.getId()),a=o.get(this.getId());for(n=0;3>n;n++)i.spec.offsets.mountPoint[n]=r.offsets.mountPoint[n],i.spec.offsets.align[n]=r.offsets.align[n],i.spec.offsets.origin[n]=r.offsets.origin[n],i.spec.vectors.position[n]=r.vectors.position[n],i.spec.vectors.rotation[n]=r.vectors.rotation[n],i.spec.vectors.scale[n]=r.vectors.scale[n],i.spec.size.sizeMode[n]=a.sizeMode[n],i.spec.size.proportional[n]=a.proportionalSize[n],i.spec.size.differential[n]=a.differentialSize[n],i.spec.size.absolute[n]=a.absoluteSize[n],i.spec.size.render[n]=a.renderSize[n];i.spec.vectors.rotation[3]=r.vectors.rotation[3]}for(n=0;t>n;n++)this._children[n]&&this._children[n].getValue&&i.children.push(this._children[n].getValue());for(n=0;e>n;n++)this._components[n]&&this._components[n].getValue&&i.components.push(this._components[n].getValue());return i},i.prototype.getComputedValue=function(){console.warn("Node.getComputedValue is depricated. Use Node.getValue instead");for(var t=this._children.length,e={location:this.getId(),computedValues:{transform:this.isMounted()?s.get(this.getLocation()).getLocalTransform():null,size:this.isMounted()?o.get(this.getLocation()).get():null},children:[]},n=0;t>n;n++)this._children[n]&&this._children[n].getComputedValue&&e.children.push(this._children[n].getComputedValue());return e},i.prototype.getChildren=function(){return this._children},i.prototype.getParent=function(){return this._parent},i.prototype.requestUpdate=function(t){return this._inUpdate||!this.isMounted()?this.requestUpdateOnNextTick(t):(this._updateQueue.push(t),this._requestingUpdate||this._requestUpdate(),this)},i.prototype.requestUpdateOnNextTick=function(t){return this._nextUpdateQueue.push(t),this},i.prototype.isMounted=function(){return this._mounted},i.prototype.isShown=function(){return this._shown},i.prototype.getOpacity=function(){return this._opacity},i.prototype.getMountPoint=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getMountPoint();if(this.isMounted())return s.get(this.getLocation()).getMountPoint();throw new Error("This node does not have access to a transform component")},i.prototype.getAlign=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getAlign();if(this.isMounted())return s.get(this.getLocation()).getAlign();throw new Error("This node does not have access to a transform component")},i.prototype.getOrigin=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getOrigin();if(this.isMounted())return s.get(this.getLocation()).getOrigin();throw new Error("This node does not have access to a transform component")},i.prototype.getPosition=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getPosition();if(this.isMounted())return s.get(this.getLocation()).getPosition();throw new Error("This node does not have access to a transform component")},i.prototype.getRotation=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getRotation();if(this.isMounted())return s.get(this.getLocation()).getRotation();throw new Error("This node does not have access to a transform component")},i.prototype.getScale=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._transformID).getScale();if(this.isMounted())return s.get(this.getLocation()).getScale();throw new Error("This node does not have access to a transform component")},i.prototype.getSizeMode=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).getSizeMode();if(this.isMounted())return o.get(this.getLocation()).getSizeMode();throw new Error("This node does not have access to a size component")},i.prototype.getProportionalSize=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).getProportional();if(this.isMounted())return o.get(this.getLocation()).getProportional();throw new Error("This node does not have access to a size component")},i.prototype.getDifferentialSize=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).getDifferential();if(this.isMounted())return o.get(this.getLocation()).getDifferential();throw new Error("This node does not have access to a size component")},i.prototype.getAbsoluteSize=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).getAbsolute();if(this.isMounted())return o.get(this.getLocation()).getAbsolute();throw new Error("This node does not have access to a size component")},i.prototype.getRenderSize=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).getRender();if(this.isMounted())return o.get(this.getLocation()).getRender();throw new Error("This node does not have access to a size component")},i.prototype.getSize=function(){if(this.constructor.INIT_DEFAULT_COMPONENTS)return this.getComponent(this._sizeID).get();if(this.isMounted())return o.get(this.getLocation()).get();throw new Error("This node does not have access to a size component")},i.prototype.getTransform=function(){return s.get(this.getLocation())},i.prototype.getUIEvents=function(){return this._UIEvents},i.prototype.addChild=function(t){var e=t?this._children.indexOf(t):-1;return t=t?t:new i,-1===e&&(e=this._freedChildIndicies.length?this._freedChildIndicies.pop():this._children.length,this._children[e]=t),this.isMounted()&&t.mount(this.getLocation()+"/"+e),t},i.prototype.removeChild=function(t){var e=this._children.indexOf(t);if(e>-1)return this._freedChildIndicies.push(e),this._children[e]=null,t.isMounted()&&t.dismount(),!0;throw new Error("Node is not a child of this node")},i.prototype.addComponent=function(t){var e=this._components.indexOf(t);return-1===e&&(e=this._freedComponentIndicies.length?this._freedComponentIndicies.pop():this._components.length,this._components[e]=t,this.isMounted()&&t.onMount&&t.onMount(this,e),this.isShown()&&t.onShow&&t.onShow()),e},i.prototype.getComponent=function(t){return this._components[t]},i.prototype.removeComponent=function(t){var e=this._components.indexOf(t);return-1!==e&&(this._freedComponentIndicies.push(e),this.isShown()&&t.onHide&&t.onHide(),this.isMounted()&&t.onDismount&&t.onDismount(),this._components[e]=null),t},i.prototype.removeUIEvent=function(t){var e,n=this.getUIEvents(),i=this._components,o=n.indexOf(t);if(-1!==o){n.splice(o,1);for(var r=0,s=i.length;s>r;r++)e=i[r],e&&e.onRemoveUIEvent&&e.onRemoveUIEvent(t)}},i.prototype.addUIEvent=function(t){var e,n=this.getUIEvents(),i=this._components,o=-1!==n.indexOf(t);if(!o){n.push(t);for(var r=0,s=i.length;s>r;r++)e=i[r],e&&e.onAddUIEvent&&e.onAddUIEvent(t)}},i.prototype._requestUpdate=function(t){(t||!this._requestingUpdate)&&(this._updater&&this._updater.requestUpdate(this),this._requestingUpdate=!0)},i.prototype._vecOptionalSet=function(t,e,n){return null!=n&&t[e]!==n?(t[e]=n,this._requestingUpdate||this._requestUpdate(),!0):!1},i.prototype.show=function(){return r.show(this.getLocation()),this._shown=!0,this},i.prototype.hide=function(){return r.hide(this.getLocation()),this._shown=!1,this},i.prototype.setAlign=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setAlign(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setAlign(t,e,n)}return this},i.prototype.setMountPoint=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setMountPoint(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setMountPoint(t,e,n)}return this},i.prototype.setOrigin=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setOrigin(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setOrigin(t,e,n)}return this},i.prototype.setPosition=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setPosition(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setPosition(t,e,n)}return this},i.prototype.setRotation=function(t,e,n,i){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setRotation(t,e,n,i);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setRotation(t,e,n,i)}return this},i.prototype.setScale=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._transformID).setScale(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a transform component");s.get(this.getLocation()).setScale(t,e,n)}return this},i.prototype.setOpacity=function(t){if(t!==this._opacity){this._opacity=t,this._requestingUpdate||this._requestUpdate();for(var e,n=0,i=this._components,o=i.length;o>n;n++)e=i[n],e&&e.onOpacityChange&&e.onOpacityChange(t)}return this},i.prototype.setSizeMode=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._sizeID).setSizeMode(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a size component");o.get(this.getLocation()).setSizeMode(t,e,n)}return this},i.prototype.setProportionalSize=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._sizeID).setProportional(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a size component");o.get(this.getLocation()).setProportional(t,e,n)}return this},i.prototype.setDifferentialSize=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._sizeID).setDifferential(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a size component");o.get(this.getLocation()).setDifferential(t,e,n)}return this},i.prototype.setAbsoluteSize=function(t,e,n){if(this.constructor.INIT_DEFAULT_COMPONENTS)this.getComponent(this._sizeID).setAbsolute(t,e,n);else{if(!this.isMounted())throw new Error("This node does not have access to a size component");o.get(this.getLocation()).setAbsolute(t,e,n)}return this},i.prototype.getFrame=function(){return this._updater.getFrame()},i.prototype.getComponents=function(){return this._components},i.prototype.update=function(t){this._inUpdate=!0;var e,n=this._nextUpdateQueue,i=this._updateQueue;for(this.onUpdate&&this.onUpdate();n.length;)i.unshift(n.pop());for(;i.length;)e=this._components[i.shift()],e&&e.onUpdate&&e.onUpdate(t);return this._inUpdate=!1,this._requestingUpdate=!1,this.isMounted()?this._nextUpdateQueue.length&&(this._updater.requestUpdateOnNextTick(this),this._requestingUpdate=!0):(this._parent=null,this._id=null),this},i.prototype.mount=function(t){if(this.isMounted())throw new Error("Node is already mounted at: "+this.getLocation());return this.constructor.INIT_DEFAULT_COMPONENTS?(s.registerTransformAtPath(t,this.getComponent(this._transformID)),o.registerSizeAtPath(t,this.getComponent(this._sizeID))):(s.registerTransformAtPath(t),o.registerSizeAtPath(t)),r.mount(t,this),this._requestingUpdate||this._requestUpdate(),this},i.prototype.dismount=function(){if(!this.isMounted())throw new Error("Node is not mounted");var t=this.getLocation();s.deregisterTransformAtPath(t),o.deregisterSizeAtPath(t),r.dismount(t),this._requestingUpdate||this._requestUpdate()},e.exports=i},{"./Dispatch":5,"./Size":12,"./SizeSystem":13,"./Transform":14,"./TransformSystem":15}],9:[function(t,e,n){"use strict";function i(){}i.prototype.hasTrailingSlash=function(t){return"/"===t[t.length-1]},i.prototype.depth=function(t){for(var e=0,n=t.length,i=this.hasTrailingSlash(t)?n-1:n,o=0;i>o;o++)e+="/"===t[o]?1:0;return e},i.prototype.index=function(t){for(var e=t.length,n=this.hasTrailingSlash(t)?e-1:e;n--&&"/"!==t[n];);var i=parseInt(t.substring(n+1));return isNaN(i)?0:i},i.prototype.indexAtDepth=function(t,e){for(var n=0,i=t.length,o=0;i>n;n++)if("/"===t[n]&&o++,o===e)return t=t.substring(n?n+1:n),o=t.indexOf("/"),t=-1===o?t:t.substring(0,o),o=parseInt(t),isNaN(o)?t:o},i.prototype.parent=function(t){return t.substring(0,t.lastIndexOf("/",t.length-2))},i.prototype.isChildOf=function(t,e){return this.isDescendentOf(t,e)&&this.depth(t)===this.depth(e)+1},i.prototype.isDescendentOf=function(t,e){return t===e?!1:(t=this.hasTrailingSlash(t)?t:t+"/",e=this.hasTrailingSlash(e)?e:e+"/",this.depth(e)<this.depth(t)&&0===t.indexOf(e))},i.prototype.getSelector=function(t){var e=t.indexOf("/");return-1===e?t:t.substring(0,e)},e.exports=new i},{}],10:[function(t,e,n){"use strict";function i(){this.items=[],this.paths=[],this.memo={}}var o=t("./Path");i.prototype.insert=function(t,e){var n=this.paths,i=n.indexOf(t);if(-1!==i)throw new Error("item already exists at path: "+t);for(var r=0,s=o.depth(t),a=o.index(t);n[r]&&s>=o.depth(n[r]);)r++;for(;n[r]&&s===o.depth(n[r])&&a<o.index(n[r]);)r++;n.splice(r,0,t),this.items.splice(r,0,e),this.memo[t]=r;for(var h=this.paths.length;h>r;r++)this.memo[this.paths[r]]=null},i.prototype.remove=function(t){var e=this.paths,n=this.memo[t]?this.memo[t]:e.indexOf(t);if(-1===n)throw new Error("Cannot remove. No item exists at path: "+t);e.splice(n,1),this.items.splice(n,1),this.memo[t]=null;for(var i=this.paths.length;i>n;n++)this.memo[this.paths[n]]=null},i.prototype.get=function(t){if(this.memo[t])return this.items[this.memo[t]];var e=this.paths.indexOf(t);return-1===e?void 0:(this.memo[t]=e,this.items[e])},i.prototype.getItems=function(){return this.items},i.prototype.getPaths=function(){return this.paths},e.exports=i},{"./Path":9}],11:[function(t,e,n){"use strict";function i(t,e){if(!t)throw new Error("Scene needs to be created with a DOM selector");if(!e)throw new Error("Scene needs to be created with a class like Famous");o.call(this),this._globalUpdater=e,this._selector=t,this.mount(t),this._globalUpdater.message(s.NEED_SIZE_FOR).message(t),this.show()}var o=t("./Node"),r=t("./Dispatch"),s=t("./Commands"),a=t("./TransformSystem"),h=t("./SizeSystem");i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.getUpdater=function(){return this._updater},i.prototype.getSelector=function(){return this._selector},i.prototype.getDispatch=function(){return console.warn("Scene#getDispatch is deprecated, require the dispatch directly"),r},i.prototype.onReceive=function(t,e){if("CONTEXT_RESIZE"===t){if(e.length<2)throw new Error("CONTEXT_RESIZE's payload needs to be at least a pair of pixel sizes");this.setSizeMode("absolute","absolute","absolute"),this.setAbsoluteSize(e[0],e[1],e[2]?e[2]:0),this._updater.message(s.WITH).message(this._selector).message(s.READY)}},i.prototype.mount=function(t){if(this.isMounted())throw new Error("Scene is already mounted at: "+this.getLocation());r.mount(t,this),this._id=t,this._mounted=!0,this._parent=this,a.registerTransformAtPath(t),h.registerSizeAtPath(t)},e.exports=i},{"./Commands":4,"./Dispatch":5,"./Node":8,"./SizeSystem":13,"./TransformSystem":15}],12:[function(t,e,n){"use strict";function i(t){this.finalSize=new Float32Array(3),this.sizeChanged=!1,this.sizeMode=new Uint8Array(3),this.sizeModeChanged=!1,this.absoluteSize=new Float32Array(3),this.absoluteSizeChanged=!1,this.proportionalSize=new Float32Array(a),
this.proportionalSizeChanged=!1,this.differentialSize=new Float32Array(3),this.differentialSizeChanged=!1,this.renderSize=new Float32Array(3),this.renderSizeChanged=!1,this.parent=null!=t?t:null}function o(t,e,n){return null!=n&&t[e]!==n?(t[e]=n,!0):!1}function r(t,e,n,i){var r=!1;return r=o(t,0,e)||r,r=o(t,1,n)||r,r=o(t,2,i)||r}function s(t){if(t.constructor===String)switch(t.toLowerCase()){case"relative":case"default":return i.RELATIVE;case"absolute":return i.ABSOLUTE;case"render":return i.RENDER;default:throw new Error("unknown size mode: "+t)}else if(0>t||t>i.RENDER)throw new Error("unknown size mode: "+t);return t}var a=[1,1,1],h=[0,0,0];i.RELATIVE=0,i.ABSOLUTE=1,i.RENDER=2,i.DEFAULT=i.RELATIVE,i.prototype.setParent=function(t){return this.parent=t,this},i.prototype.getParent=function(){return this.parent},i.prototype.setSizeMode=function(t,e,n){return null!=t&&(t=s(t)),null!=e&&(e=s(e)),null!=n&&(n=s(n)),this.sizeModeChanged=r(this.sizeMode,t,e,n),this},i.prototype.getSizeMode=function(){return this.sizeMode},i.prototype.setAbsolute=function(t,e,n){return this.absoluteSizeChanged=r(this.absoluteSize,t,e,n),this},i.prototype.getAbsolute=function(){return this.absoluteSize},i.prototype.setProportional=function(t,e,n){return this.proportionalSizeChanged=r(this.proportionalSize,t,e,n),this},i.prototype.getProportional=function(){return this.proportionalSize},i.prototype.setDifferential=function(t,e,n){return this.differentialSizeChanged=r(this.differentialSize,t,e,n),this},i.prototype.getDifferential=function(){return this.differentialSize},i.prototype.get=function(){return this.finalSize},i.prototype.fromComponents=function(t){for(var e,n,o=this.sizeMode,r=this.finalSize,s=this.parent?this.parent.get():h,a=!1,u=t.length,c=0;3>c;c++){switch(e=r[c],o[c]){case i.RELATIVE:r[c]=s[c]*this.proportionalSize[c]+this.differentialSize[c];break;case i.ABSOLUTE:r[c]=this.absoluteSize[c];break;case i.RENDER:var p,l;for(n=0;u>n;n++)l=t[n],l&&l.getRenderSize&&(p=l.getRenderSize()[c],r[c]=r[c]<p||0===r[c]?p:r[c])}a=a||e!==r[c]}return this.sizeChanged=a,a},e.exports=i},{}],13:[function(t,e,n){"use strict";function i(){this.pathStore=new c}function o(t,e,n){var i=n.getSizeMode(),o=i[0],r=i[1],s=i[2];t.onSizeModeChange&&t.onSizeModeChange(o,r,s);for(var a=0,h=e.length;h>a;a++)e[a]&&e[a].onSizeModeChange&&e[a].onSizeModeChange(o,r,s);n.sizeModeChanged=!1}function r(t,e,n){var i=n.getAbsolute(),o=i[0],r=i[1],s=i[2];t.onAbsoluteSizeChange&&t.onAbsoluteSizeChange(o,r,s);for(var a=0,h=e.length;h>a;a++)e[a]&&e[a].onAbsoluteSizeChange&&e[a].onAbsoluteSizeChange(o,r,s);n.absoluteSizeChanged=!1}function s(t,e,n){var i=n.getProportional(),o=i[0],r=i[1],s=i[2];t.onProportionalSizeChange&&t.onProportionalSizeChange(o,r,s);for(var a=0,h=e.length;h>a;a++)e[a]&&e[a].onProportionalSizeChange&&e[a].onProportionalSizeChange(o,r,s);n.proportionalSizeChanged=!1}function a(t,e,n){var i=n.getDifferential(),o=i[0],r=i[1],s=i[2];t.onDifferentialSizeChange&&t.onDifferentialSizeChange(o,r,s);for(var a=0,h=e.length;h>a;a++)e[a]&&e[a].onDifferentialSizeChange&&e[a].onDifferentialSizeChange(o,r,s);n.differentialSizeChanged=!1}function h(t,e,n){var i=n.getRenderSize(),o=i[0],r=i[1],s=i[2];t.onRenderSizeChange&&t.onRenderSizeChange(o,r,s);for(var a=0,h=e.length;h>a;a++)e[a]&&e[a].onRenderSizeChange&&e[a].onRenderSizeChange(o,r,s);n.renderSizeChanged=!1}function u(t,e,n){var i=n.get(),o=i[0],r=i[1],s=i[2];t.onSizeChange&&t.onSizeChange(o,r,s);for(var a=0,h=e.length;h>a;a++)e[a]&&e[a].onSizeChange&&e[a].onSizeChange(o,r,s);n.sizeChanged=!1}var c=t("./PathStore"),p=t("./Size"),l=t("./Dispatch"),f=t("./Path");i.prototype.registerSizeAtPath=function(t,e){if(!f.depth(t))return this.pathStore.insert(t,e?e:new p);var n=this.pathStore.get(f.parent(t));if(!n)throw new Error("No parent size registered at expected path: "+f.parent(t));e&&e.setParent(n),this.pathStore.insert(t,e?e:new p(n))},i.prototype.deregisterSizeAtPath=function(t){this.pathStore.remove(t)},i.prototype.get=function(t){return this.pathStore.get(t)},i.prototype.update=function(){var t,e,n,i,c,p=this.pathStore.getItems(),f=this.pathStore.getPaths();for(n=0,i=p.length;i>n;n++)t=l.getNode(f[n]),c=t.getComponents(),t&&(e=p[n],e.sizeModeChanged&&o(t,c,e),e.absoluteSizeChanged&&r(t,c,e),e.proportionalSizeChanged&&s(t,c,e),e.differentialSizeChanged&&a(t,c,e),e.renderSizeChanged&&h(t,c,e),e.fromComponents(c)&&u(t,c,e))},e.exports=new i},{"./Dispatch":5,"./Path":9,"./PathStore":10,"./Size":12}],14:[function(t,e,n){"use strict";function i(t){this.local=new Float32Array(i.IDENT),this.global=new Float32Array(i.IDENT),this.offsets={align:new Float32Array(3),alignChanged:!1,mountPoint:new Float32Array(3),mountPointChanged:!1,origin:new Float32Array(3),originChanged:!1},this.vectors={position:new Float32Array(3),positionChanged:!1,rotation:new Float32Array(u),rotationChanged:!1,scale:new Float32Array(c),scaleChanged:!1},this._lastEulerVals=[0,0,0],this._lastEuler=!1,this.parent=t?t:null,this.breakPoint=!1}function o(t,e,n){return null!=n&&t[e]!==n?(t[e]=n,!0):!1}function r(t,e,n,i,r){var s=!1;return s=o(t,0,e)||s,s=o(t,1,n)||s,s=o(t,2,i)||s,null!=r&&(s=o(t,3,r)||s),s}function s(t,e){var n=e.getLocalTransform(),o=t.getSize(),r=e.vectors,s=e.offsets,a=t.getParent().getSize(),h=0,u=n[0],c=n[1],p=n[2],l=n[4],f=n[5],d=n[6],m=n[8],_=n[9],g=n[10],y=n[12],v=n[13],T=n[14],E=r.position[0],b=r.position[1],R=r.position[2],S=r.rotation[0],C=r.rotation[1],w=r.rotation[2],I=r.rotation[3],O=r.scale[0],A=r.scale[1],N=r.scale[2],L=s.align[0]*a[0],M=s.align[1]*a[1],D=s.align[2]*a[2],U=s.mountPoint[0]*o[0],P=s.mountPoint[1]*o[1],x=s.mountPoint[2]*o[2],z=s.origin[0]*o[0],F=s.origin[1]*o[1],H=s.origin[2]*o[2],G=I*S,k=I*C,q=I*w,W=S*S,B=C*C,V=w*w,Y=S*C,K=S*w,j=C*w;return n[0]=(1-2*(B+V))*O,n[1]=2*(Y+q)*O,n[2]=2*(K-k)*O,n[3]=0,n[4]=2*(Y-q)*A,n[5]=(1-2*(W+V))*A,n[6]=2*(j+G)*A,n[7]=0,n[8]=2*(K+k)*N,n[9]=2*(j-G)*N,n[10]=(1-2*(W+B))*N,n[11]=0,n[12]=L+E-U+z-(n[0]*z+n[4]*F+n[8]*H),n[13]=M+b-P+F-(n[1]*z+n[5]*F+n[9]*H),n[14]=D+R-x+H-(n[2]*z+n[6]*F+n[10]*H),n[15]=1,e.isBreakPoint()&&e.calculateWorldMatrix()&&(h|=i.WORLD_CHANGED),(u!==n[0]||c!==n[1]||p!==n[2]||l!==n[4]||f!==n[5]||d!==n[6]||m!==n[8]||_!==n[9]||g!==n[10]||y!==n[12]||v!==n[13]||T!==n[14])&&(h|=i.LOCAL_CHANGED),h}function a(t,e){var n=e.getLocalTransform(),o=e.parent.getLocalTransform(),r=t.getSize(),s=e.vectors,a=e.offsets,h=t.getParent().getSize(),u=!1,c=n[0],p=n[1],l=n[2],f=n[4],d=n[5],m=n[6],_=n[8],g=n[9],y=n[10],v=n[12],T=n[13],E=n[14],b=o[0],R=o[1],S=o[2],C=o[4],w=o[5],I=o[6],O=o[8],A=o[9],N=o[10],L=o[12],M=o[13],D=o[14],U=s.position[0],P=s.position[1],x=s.position[2],z=s.rotation[0],F=s.rotation[1],H=s.rotation[2],G=s.rotation[3],k=s.scale[0],q=s.scale[1],W=s.scale[2],B=a.align[0]*h[0],V=a.align[1]*h[1],Y=a.align[2]*h[2],K=a.mountPoint[0]*r[0],j=a.mountPoint[1]*r[1],Q=a.mountPoint[2]*r[2],X=a.origin[0]*r[0],J=a.origin[1]*r[1],Z=a.origin[2]*r[2],$=G*z,tt=G*F,et=G*H,nt=z*z,it=F*F,ot=H*H,rt=z*F,st=z*H,at=F*H,ht=(1-2*(it+ot))*k,ut=2*(rt+et)*k,ct=2*(st-tt)*k,pt=2*(rt-et)*q,lt=(1-2*(nt+ot))*q,ft=2*(at+$)*q,dt=2*(st+tt)*W,mt=2*(at-$)*W,_t=(1-2*(nt+it))*W,gt=B+U-K+X-(ht*X+pt*J+dt*Z),yt=V+P-j+J-(ut*X+lt*J+mt*Z),vt=Y+x-Q+Z-(ct*X+ft*J+_t*Z);return n[0]=b*ht+C*ut+O*ct,n[1]=R*ht+w*ut+A*ct,n[2]=S*ht+I*ut+N*ct,n[3]=0,n[4]=b*pt+C*lt+O*ft,n[5]=R*pt+w*lt+A*ft,n[6]=S*pt+I*lt+N*ft,n[7]=0,n[8]=b*dt+C*mt+O*_t,n[9]=R*dt+w*mt+A*_t,n[10]=S*dt+I*mt+N*_t,n[11]=0,n[12]=b*gt+C*yt+O*vt+L,n[13]=R*gt+w*yt+A*vt+M,n[14]=S*gt+I*yt+N*vt+D,n[15]=1,e.isBreakPoint()&&e.calculateWorldMatrix()&&(u|=i.WORLD_CHANGED),(c!==n[0]||p!==n[1]||l!==n[2]||f!==n[4]||d!==n[5]||m!==n[6]||_!==n[8]||g!==n[9]||y!==n[10]||v!==n[12]||T!==n[13]||E!==n[14])&&(u|=i.LOCAL_CHANGED),u}function h(t,e,n){var i,o=e[0],r=e[1],s=e[2],a=e[4],h=e[5],u=e[6],c=e[8],p=e[9],l=e[10],f=e[12],d=e[13],m=e[14],_=!1,g=n[0],y=n[1],v=n[2],T=n[3];return i=g*o+y*a+v*c+T*f,_=_?_:t[0]===i,t[0]=i,i=g*r+y*h+v*p+T*d,_=_?_:t[1]===i,t[1]=i,i=g*s+y*u+v*l+T*m,_=_?_:t[2]===i,t[2]=i,t[3]=0,g=n[4],y=n[5],v=n[6],T=n[7],i=g*o+y*a+v*c+T*f,_=_?_:t[4]===i,t[4]=i,i=g*r+y*h+v*p+T*d,_=_?_:t[5]===i,t[5]=i,i=g*s+y*u+v*l+T*m,_=_?_:t[6]===i,t[6]=i,t[7]=0,g=n[8],y=n[9],v=n[10],T=n[11],i=g*o+y*a+v*c+T*f,_=_?_:t[8]===i,t[8]=i,i=g*r+y*h+v*p+T*d,_=_?_:t[9]===i,t[9]=i,i=g*s+y*u+v*l+T*m,_=_?_:t[10]===i,t[10]=i,t[11]=0,g=n[12],y=n[13],v=n[14],T=n[15],i=g*o+y*a+v*c+T*f,_=_?_:t[12]===i,t[12]=i,i=g*r+y*h+v*p+T*d,_=_?_:t[13]===i,t[13]=i,i=g*s+y*u+v*l+T*m,_=_?_:t[14]===i,t[14]=i,t[15]=1,_}var u=[0,0,0,1],c=[1,1,1];i.IDENT=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i.WORLD_CHANGED=1,i.LOCAL_CHANGED=2,i.prototype.reset=function(){this.parent=null,this.breakPoint=!1},i.prototype.setParent=function(t){this.parent=t},i.prototype.getParent=function(){return this.parent},i.prototype.setBreakPoint=function(){this.breakPoint=!0},i.prototype.isBreakPoint=function(){return this.breakPoint},i.prototype.getLocalTransform=function(){return this.local},i.prototype.getWorldTransform=function(){if(!this.isBreakPoint())throw new Error("This transform is not calculating world transforms");return this.global},i.prototype.calculate=function(t){return!this.parent||this.parent.isBreakPoint()?s(t,this):a(t,this)},i.prototype.getPosition=function(){return this.vectors.position},i.prototype.setPosition=function(t,e,n){this.vectors.positionChanged=r(this.vectors.position,t,e,n)},i.prototype.getRotation=function(){return this.vectors.rotation},i.prototype.setRotation=function(t,e,n,i){var o,s,a,h,u=this.vectors.rotation;if(null!=i)o=t,s=e,a=n,h=i,this._lastEulerVals[0]=null,this._lastEulerVals[1]=null,this._lastEulerVals[2]=null,this._lastEuler=!1;else{if(null==t||null==e||null==n)if(this._lastEuler)t=null==t?this._lastEulerVals[0]:t,e=null==e?this._lastEulerVals[1]:e,n=null==n?this._lastEulerVals[2]:n;else{var c=-2*(u[1]*u[2]-u[3]*u[0]);Math.abs(c)>.99999?(e=null==e?.5*Math.PI*c:e,t=null==t?Math.atan2(-u[0]*u[2]+u[3]*u[1],.5-u[1]*u[1]-u[2]*u[2]):t,n=null==n?0:n):(e=null==e?Math.asin(c):e,t=null==t?Math.atan2(u[0]*u[2]+u[3]*u[1],.5-u[0]*u[0]-u[1]*u[1]):t,n=null==n?Math.atan2(u[0]*u[1]+u[3]*u[2],.5-u[0]*u[0]-u[2]*u[2]):n)}var p=.5*t,l=.5*e,f=.5*n,d=Math.sin(p),m=Math.sin(l),_=Math.sin(f),g=Math.cos(p),y=Math.cos(l),v=Math.cos(f),T=m*_,E=y*_,b=m*v,R=y*v;o=d*R+g*T,s=g*b-d*E,a=g*E+d*b,h=g*R-d*T,this._lastEuler=!0,this._lastEulerVals[0]=t,this._lastEulerVals[1]=e,this._lastEulerVals[2]=n}this.vectors.rotationChanged=r(u,o,s,a,h)},i.prototype.getScale=function(){return this.vectors.scale},i.prototype.setScale=function(t,e,n){this.vectors.scaleChanged=r(this.vectors.scale,t,e,n)},i.prototype.getAlign=function(){return this.offsets.align},i.prototype.setAlign=function(t,e,n){this.offsets.alignChanged=r(this.offsets.align,t,e,null!=n?n-.5:n)},i.prototype.getMountPoint=function(){return this.offsets.mountPoint},i.prototype.setMountPoint=function(t,e,n){this.offsets.mountPointChanged=r(this.offsets.mountPoint,t,e,null!=n?n-.5:n)},i.prototype.getOrigin=function(){return this.offsets.origin},i.prototype.setOrigin=function(t,e,n){this.offsets.originChanged=r(this.offsets.origin,t,e,null!=n?n-.5:n)},i.prototype.calculateWorldMatrix=function(){for(var t=this.parent;t&&!t.isBreakPoint();)t=t.parent;if(t)return h(this.global,t.getWorldTransform(),this.local);for(var e=0;16>e;e++)this.global[e]=this.local[e];return!1},e.exports=i},{}],15:[function(t,e,n){"use strict";function i(){this.pathStore=new _}function o(t,e,n){var i=n.align[0],o=n.align[1],r=n.align[2];t.onAlignChange&&t.onAlignChange(i,o,r);for(var s=0,a=e.length;a>s;s++)e[s]&&e[s].onAlignChange&&e[s].onAlignChange(i,o,r);n.alignChanged=!1}function r(t,e,n){var i=n.mountPoint[0],o=n.mountPoint[1],r=n.mountPoint[2];t.onMountPointChange&&t.onMountPointChange(i,o,r);for(var s=0,a=e.length;a>s;s++)e[s]&&e[s].onMountPointChange&&e[s].onMountPointChange(i,o,r);n.mountPointChanged=!1}function s(t,e,n){var i=n.origin[0],o=n.origin[1],r=n.origin[2];t.onOriginChange&&t.onOriginChange(i,o,r);for(var s=0,a=e.length;a>s;s++)e[s]&&e[s].onOriginChange&&e[s].onOriginChange(i,o,r);n.originChanged=!1}function a(t,e,n){var i=n.position[0],o=n.position[1],r=n.position[2];t.onPositionChange&&t.onPositionChange(i,o,r);for(var s=0,a=e.length;a>s;s++)e[s]&&e[s].onPositionChange&&e[s].onPositionChange(i,o,r);n.positionChanged=!1}function h(t,e,n){var i=n.rotation[0],o=n.rotation[1],r=n.rotation[2],s=n.rotation[3];t.onRotationChange&&t.onRotationChange(i,o,r,s);for(var a=0,h=e.length;h>a;a++)e[a]&&e[a].onRotationChange&&e[a].onRotationChange(i,o,r,s);n.rotationChanged=!1}function u(t,e,n){var i=n.scale[0],o=n.scale[1],r=n.scale[2];t.onScaleChange&&t.onScaleChange(i,o,r);for(var s=0,a=e.length;a>s;s++)e[s]&&e[s].onScaleChange&&e[s].onScaleChange(i,o,r);n.scaleChanged=!1}function c(t,e,n){t.onTransformChange&&t.onTransformChange(n);for(var i=0,o=e.length;o>i;i++)e[i]&&e[i].onTransformChange&&e[i].onTransformChange(n)}function p(t,e,n){t.onLocalTransformChange&&t.onLocalTransformChange(n);for(var i=0,o=e.length;o>i;i++)e[i]&&e[i].onLocalTransformChange&&e[i].onLocalTransformChange(n)}function l(t,e,n){t.onWorldTransformChange&&t.onWorldTransformChange(n);for(var i=0,o=e.length;o>i;i++)e[i]&&e[i].onWorldTransformChange&&e[i].onWorldTransformChange(n)}var f=t("./Path"),d=t("./Transform"),m=t("./Dispatch"),_=t("./PathStore");i.prototype.registerTransformAtPath=function(t,e){if(!f.depth(t))return this.pathStore.insert(t,e?e:new d);var n=this.pathStore.get(f.parent(t));if(!n)throw new Error("No parent transform registered at expected path: "+f.parent(t));e&&e.setParent(n),this.pathStore.insert(t,e?e:new d(n))},i.prototype.deregisterTransformAtPath=function(t){this.pathStore.remove(t)},i.prototype.makeBreakPointAt=function(t){var e=this.pathStore.get(t);if(!e)throw new Error("No transform Registered at path: "+t);e.setBreakPoint()},i.prototype.get=function(t){return this.pathStore.get(t)},i.prototype.onUpdate=function(){for(var t,e,n,i,f,_,g=this.pathStore.getItems(),y=this.pathStore.getPaths(),v=0,T=g.length;T>v;v++)n=m.getNode(y[v]),n&&(_=n.getComponents(),t=g[v],i=t.vectors,f=t.offsets,f.alignChanged&&o(n,_,f),f.mountPointChanged&&r(n,_,f),f.originChanged&&s(n,_,f),i.positionChanged&&a(n,_,i),i.rotationChanged&&h(n,_,i),i.scaleChanged&&u(n,_,i),(e=t.calculate(n))&&(c(n,_,t),e&d.LOCAL_CHANGED&&p(n,_,t.getLocalTransform()),e&d.WORLD_CHANGED&&l(n,_,t.getWorldTransform())))},e.exports=new i},{"./Dispatch":5,"./Path":9,"./PathStore":10,"./Transform":14}],16:[function(t,e,n){"use strict";function i(t,e){if(!t)throw new Error("DOMElement must be instantiated on a node");if(this._changeQueue=[],this._requestingUpdate=!1,this._renderSized=!1,this._requestRenderSize=!1,this._UIEvents=t.getUIEvents().slice(0),this._classes=["famous-dom-element"],this._requestingEventListeners=[],this._styles={},this._attributes={},this._content="",this._tagName=e&&e.tagName?e.tagName:"div",this._renderSize=[0,0,0],this._id=t?t.addComponent(this):null,this._node=t,this.onSizeModeChange.apply(this,t.getSizeMode()),this._callbacks=new o,this.setProperty("display",t.isShown()?"block":"none"),this.onOpacityChange(t.getOpacity()),e){var n,i;if(e.classes)for(n=0;n<e.classes.length;n++)this.addClass(e.classes[n]);if(e.attributes)for(i in e.attributes)this.setAttribute(i,e.attributes[i]);if(e.properties)for(i in e.properties)this.setProperty(i,e.properties[i]);e.id&&this.setId(e.id),e.content&&this.setContent(e.content),e.cutout===!1&&this.setCutoutState(e.cutout)}}var o=t("../utilities/CallbackStore"),r=t("../core/TransformSystem"),s=t("../core/Commands"),a=2;i.prototype.getValue=function(){return{classes:this._classes,styles:this._styles,attributes:this._attributes,content:this._content,id:this._attributes.id,tagName:this._tagName}},i.prototype.onUpdate=function(){var t=this._node,e=this._changeQueue,n=e.length;if(n&&t){for(t.sendDrawCommand(s.WITH),t.sendDrawCommand(t.getLocation());n--;)t.sendDrawCommand(e.shift());this._requestRenderSize&&(t.sendDrawCommand(s.DOM_RENDER_SIZE),t.sendDrawCommand(t.getLocation()),this._requestRenderSize=!1)}this._requestingUpdate=!1},i.prototype.onMount=function(t,e){this._node=t,this._id=e,this._UIEvents=t.getUIEvents().slice(0),r.makeBreakPointAt(t.getLocation()),this.draw(),this.setAttribute("data-fa-path",t.getLocation())},i.prototype.onDismount=function(){this.setProperty("display","none"),this.setAttribute("data-fa-path",""),this.setCutoutState(!1),this.onUpdate(),this._initialized=!1},i.prototype.onShow=function(){this.setProperty("display","block")},i.prototype.onHide=function(){this.setProperty("display","none")},i.prototype.setCutoutState=function(t){return this._initialized&&this._changeQueue.push(s.GL_CUTOUT_STATE,t),this._requestingUpdate||this._requestUpdate(),this},i.prototype.onTransformChange=function(t){this._changeQueue.push(s.CHANGE_TRANSFORM),t=t.getLocalTransform();for(var e=0,n=t.length;n>e;e++)this._changeQueue.push(t[e]);this._requestingUpdate||this._requestUpdate()},i.prototype.onSizeChange=function(t,e){var n=this._node.getSizeMode(),i=n[0]!==a,o=n[1]!==a;return this._initialized&&this._changeQueue.push(s.CHANGE_SIZE,i?t:i,o?e:o),this._requestingUpdate||this._requestUpdate(),this},i.prototype.onOpacityChange=function(t){return this.setProperty("opacity",t)},i.prototype.onAddUIEvent=function(t){return-1===this._UIEvents.indexOf(t)?(this._subscribe(t),this._UIEvents.push(t)):this._inDraw&&this._subscribe(t),this},i.prototype.onRemoveUIEvent=function(t){var e=this._UIEvents.indexOf(t);return-1!==e?(this._unsubscribe(t),this._UIEvents.splice(e,1)):this._inDraw&&this._unsubscribe(t),this},i.prototype._subscribe=function(t){this._initialized&&this._changeQueue.push(s.SUBSCRIBE,t),this._requestingUpdate||this._requestUpdate()},i.prototype.preventDefault=function(t){this._initialized&&this._changeQueue.push(s.PREVENT_DEFAULT,t),this._requestingUpdate||this._requestUpdate()},i.prototype.allowDefault=function(t){this._initialized&&this._changeQueue.push(s.ALLOW_DEFAULT,t),this._requestingUpdate||this._requestUpdate()},i.prototype._unsubscribe=function(t){this._initialized&&this._changeQueue.push("UNSUBSCRIBE",t),this._requestingUpdate||this._requestUpdate()},i.prototype.onSizeModeChange=function(t,e,n){(t===a||e===a||n===a)&&(this._renderSized=!0,this._requestRenderSize=!0);var i=this._node.getSize();this.onSizeChange(i[0],i[1])},i.prototype.getRenderSize=function(){return this._renderSize},i.prototype._requestUpdate=function(){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0)},i.prototype.init=function(){this._changeQueue.push(s.INIT_DOM,this._tagName),this._initialized=!0,this.onTransformChange(r.get(this._node.getLocation()));var t=this._node.getSize();this.onSizeChange(t[0],t[1]),this._requestingUpdate||this._requestUpdate()},i.prototype.setId=function(t){return this.setAttribute("id",t),this},i.prototype.addClass=function(t){return this._classes.indexOf(t)<0?(this._initialized&&this._changeQueue.push(s.ADD_CLASS,t),this._classes.push(t),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0),this):(this._inDraw&&(this._initialized&&this._changeQueue.push(s.ADD_CLASS,t),this._requestingUpdate||this._requestUpdate()),this)},i.prototype.removeClass=function(t){var e=this._classes.indexOf(t);return 0>e?this:(this._changeQueue.push(s.REMOVE_CLASS,t),this._classes.splice(e,1),this._requestingUpdate||this._requestUpdate(),this)},i.prototype.hasClass=function(t){return-1!==this._classes.indexOf(t)},i.prototype.setAttribute=function(t,e){return(this._attributes[t]!==e||this._inDraw)&&(this._attributes[t]=e,this._initialized&&this._changeQueue.push(s.CHANGE_ATTRIBUTE,t,e),this._requestUpdate||this._requestUpdate()),this},i.prototype.setProperty=function(t,e){return(this._styles[t]!==e||this._inDraw)&&(this._styles[t]=e,this._initialized&&this._changeQueue.push(s.CHANGE_PROPERTY,t,e),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0)),this},i.prototype.setContent=function(t){return(this._content!==t||this._inDraw)&&(this._content=t,this._initialized&&this._changeQueue.push(s.CHANGE_CONTENT,t),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0)),this},i.prototype.on=function(t,e){return this._callbacks.on(t,e)},i.prototype.onReceive=function(t,e){"resize"===t&&(this._renderSize[0]=e.val[0],this._renderSize[1]=e.val[1],this._requestingUpdate||this._requestUpdate()),this._callbacks.trigger(t,e)},i.prototype.draw=function(){var t,e,n;for(this._inDraw=!0,this.init(),e=0,n=this._classes.length;n>e;e++)this.addClass(this._classes[e]);this._content&&this.setContent(this._content);for(t in this._styles)null!=this._styles[t]&&this.setProperty(t,this._styles[t]);for(t in this._attributes)null!=this._attributes[t]&&this.setAttribute(t,this._attributes[t]);for(e=0,n=this._UIEvents.length;n>e;e++)this.onAddUIEvent(this._UIEvents[e]);this._inDraw=!1},e.exports=i},{"../core/Commands":4,"../core/TransformSystem":15,"../utilities/CallbackStore":40}],17:[function(t,e,n){"use strict";function i(t,e,n){var i=this;t.classList.add("famous-dom-renderer"),c=c||h("transform"),this._compositor=n,this._target=null,this._parent=null,this._path=null,this._children=[],this._root=new r(t,e),this._boundTriggerEvent=function(t){return i._triggerEvent(t)},this._selector=e,this._elements={},this._elements[e]=this._root,this.perspectiveTransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._VPtransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._lastEv=null}function o(t){for(var e=[],n=t.target;n!==document.body;)e.push(n),n=n.parentNode;return e}var r=t("./ElementCache"),s=t("./Math"),a=t("../core/Path"),h=t("../utilities/vendorPrefix"),u=t("./events/EventMap"),c=null;i.prototype.subscribe=function(t){this._assertTargetLoaded(),this._listen(t),this._target.subscribe[t]=!0},i.prototype.unsubscribe=function(t){this._assertTargetLoaded(),this._listen(t),this._target.subscribe[t]=!1},i.prototype.preventDefault=function(t){this._assertTargetLoaded(),this._listen(t),this._target.preventDefault[t]=!0},i.prototype.allowDefault=function(t){this._assertTargetLoaded(),this._listen(t),this._target.preventDefault[t]=!1},i.prototype._listen=function(t){if(this._assertTargetLoaded(),!this._target.listeners[t]&&!this._root.listeners[t]){var e=u[t][1]?this._root:this._target;e.listeners[t]=this._boundTriggerEvent,e.element.addEventListener(t,this._boundTriggerEvent)}},i.prototype.unsubscribe=function(t){this._assertTargetLoaded(),this._target.subscribe[t]=!1},i.prototype._triggerEvent=function(t){if(this._lastEv!==t)for(var e=t.path?t.path:o(t),n=0;n<e.length;n++)if(e[n].dataset){var i=e[n].dataset.faPath;if(i&&(this._elements[i].preventDefault[t.type]&&t.preventDefault(),this._elements[i]&&this._elements[i].subscribe[t.type])){this._lastEv=t;var r=u[t.type][0];this._compositor.sendEvent(i,t.type,new r(t));break}}},i.prototype.getSizeOf=function(t){var e=this._elements[t];if(!e)return null;var n={val:e.size};return this._compositor.sendEvent(t,"resize",n),n},i.prototype.draw=function(t){t.perspectiveDirty&&(this.perspectiveDirty=!0,this.perspectiveTransform[0]=t.perspectiveTransform[0],this.perspectiveTransform[1]=t.perspectiveTransform[1],this.perspectiveTransform[2]=t.perspectiveTransform[2],this.perspectiveTransform[3]=t.perspectiveTransform[3],this.perspectiveTransform[4]=t.perspectiveTransform[4],this.perspectiveTransform[5]=t.perspectiveTransform[5],this.perspectiveTransform[6]=t.perspectiveTransform[6],this.perspectiveTransform[7]=t.perspectiveTransform[7],this.perspectiveTransform[8]=t.perspectiveTransform[8],this.perspectiveTransform[9]=t.perspectiveTransform[9],this.perspectiveTransform[10]=t.perspectiveTransform[10],this.perspectiveTransform[11]=t.perspectiveTransform[11],this.perspectiveTransform[12]=t.perspectiveTransform[12],this.perspectiveTransform[13]=t.perspectiveTransform[13],this.perspectiveTransform[14]=t.perspectiveTransform[14],this.perspectiveTransform[15]=t.perspectiveTransform[15]),(t.viewDirty||t.perspectiveDirty)&&(s.multiply(this._VPtransform,this.perspectiveTransform,t.viewTransform),this._root.element.style[c]=this._stringifyMatrix(this._VPtransform))},i.prototype._assertPathLoaded=function(){if(!this._path)throw new Error("path not loaded")},i.prototype._assertParentLoaded=function(){if(!this._parent)throw new Error("parent not loaded")},i.prototype._assertChildrenLoaded=function(){if(!this._children)throw new Error("children not loaded")},i.prototype._assertTargetLoaded=function(){if(!this._target)throw new Error("No target loaded")},i.prototype.findParent=function(){this._assertPathLoaded();for(var t,e=this._path;!t&&e.length;)e=e.substring(0,e.lastIndexOf("/")),t=this._elements[e];return this._parent=t,t},i.prototype.findTarget=function(){return this._target=this._elements[this._path],this._target},i.prototype.loadPath=function(t){return this._path=t,this._path},i.prototype.resolveChildren=function(t,e){for(var n,i,o=0,r=this._path;n=e.childNodes[o];)n.dataset?(i=n.dataset.faPath,i&&a.isDescendentOf(i,r)?t.appendChild(n):o++):o++},i.prototype.insertEl=function(t){if(!this._target||this._target.element.tagName.toLowerCase()!==t.toLowerCase()){if(this.findParent(),this._assertParentLoaded(),this._parent.void)throw new Error(this._parent.path+" is a void element. Void elements are not allowed to have children.");this._target&&this._parent.element.removeChild(this._target.element),this._target=new r(document.createElement(t),this._path);var e=this._target.element,n=this._parent.element;this.resolveChildren(e,n),this._parent.element.appendChild(this._target.element),this._elements[this._path]=this._target}},i.prototype.setProperty=function(t,e){this._assertTargetLoaded(),this._target.element.style[t]=e},i.prototype.setSize=function(t,e){this._assertTargetLoaded(),this.setWidth(t),this.setHeight(e)},i.prototype.setWidth=function(t){this._assertTargetLoaded();var e=this._target.content;t===!1?(this._target.explicitWidth=!0,e&&(e.style.width=""),t=e?e.offsetWidth:0,this._target.element.style.width=t+"px"):(this._target.explicitWidth=!1,e&&(e.style.width=t+"px"),this._target.element.style.width=t+"px"),this._target.size[0]=t},i.prototype.setHeight=function(t){this._assertTargetLoaded();var e=this._target.content;t===!1?(this._target.explicitHeight=!0,e&&(e.style.height=""),t=e?e.offsetHeight:0,this._target.element.style.height=t+"px"):(this._target.explicitHeight=!1,e&&(e.style.height=t+"px"),this._target.element.style.height=t+"px"),this._target.size[1]=t},i.prototype.setAttribute=function(t,e){this._assertTargetLoaded(),this._target.element.setAttribute(t,e)},i.prototype.setContent=function(t){this._assertTargetLoaded(),this._target.formElement?this._target.element.value=t:(this._target.content||(this._target.content=document.createElement("div"),this._target.content.classList.add("famous-dom-element-content"),this._target.element.insertBefore(this._target.content,this._target.element.firstChild)),this._target.content.innerHTML=t),this.setSize(this._target.explicitWidth?!1:this._target.size[0],this._target.explicitHeight?!1:this._target.size[1])},i.prototype.setMatrix=function(t){this._assertTargetLoaded(),this._target.element.style[c]=this._stringifyMatrix(t)},i.prototype.addClass=function(t){this._assertTargetLoaded(),this._target.element.classList.add(t)},i.prototype.removeClass=function(t){this._assertTargetLoaded(),this._target.element.classList.remove(t)},i.prototype._stringifyMatrix=function(t){var e="matrix3d(";return e+=t[0]<1e-6&&t[0]>-1e-6?"0,":t[0]+",",e+=t[1]<1e-6&&t[1]>-1e-6?"0,":t[1]+",",e+=t[2]<1e-6&&t[2]>-1e-6?"0,":t[2]+",",e+=t[3]<1e-6&&t[3]>-1e-6?"0,":t[3]+",",e+=t[4]<1e-6&&t[4]>-1e-6?"0,":t[4]+",",e+=t[5]<1e-6&&t[5]>-1e-6?"0,":t[5]+",",e+=t[6]<1e-6&&t[6]>-1e-6?"0,":t[6]+",",e+=t[7]<1e-6&&t[7]>-1e-6?"0,":t[7]+",",e+=t[8]<1e-6&&t[8]>-1e-6?"0,":t[8]+",",e+=t[9]<1e-6&&t[9]>-1e-6?"0,":t[9]+",",e+=t[10]<1e-6&&t[10]>-1e-6?"0,":t[10]+",",e+=t[11]<1e-6&&t[11]>-1e-6?"0,":t[11]+",",e+=t[12]<1e-6&&t[12]>-1e-6?"0,":t[12]+",",e+=t[13]<1e-6&&t[13]>-1e-6?"0,":t[13]+",",e+=t[14]<1e-6&&t[14]>-1e-6?"0,":t[14]+",",e+=t[15]+")"},e.exports=i},{"../core/Path":9,"../utilities/vendorPrefix":43,"./ElementCache":18,"./Math":19,"./events/EventMap":23}],18:[function(t,e,n){"use strict";function i(t,e){this.tagName=t.tagName.toLowerCase(),this.void=o[this.tagName];var n=t.constructor;this.formElement=n===HTMLInputElement||n===HTMLTextAreaElement||n===HTMLSelectElement,this.element=t,this.path=e,this.content=null,this.size=new Int16Array(3),this.explicitHeight=!1,this.explicitWidth=!1,this.postRenderSize=new Float32Array(2),this.listeners={},this.preventDefault={},this.subscribe={}}var o=t("./VoidElements");e.exports=i},{"./VoidElements":20}],19:[function(t,e,n){"use strict";function i(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],a=e[5],h=e[6],u=e[7],c=e[8],p=e[9],l=e[10],f=e[11],d=e[12],m=e[13],_=e[14],g=e[15],y=n*a-i*s,v=n*h-o*s,T=n*u-r*s,E=i*h-o*a,b=i*u-r*a,R=o*u-r*h,S=c*m-p*d,C=c*_-l*d,w=c*g-f*d,I=p*_-l*m,O=p*g-f*m,A=l*g-f*_,N=y*A-v*O+T*I+E*w-b*C+R*S;return N?(N=1/N,t[0]=(a*A-h*O+u*I)*N,t[1]=(o*O-i*A-r*I)*N,t[2]=(m*R-_*b+g*E)*N,t[3]=(l*b-p*R-f*E)*N,t[4]=(h*w-s*A-u*C)*N,t[5]=(n*A-o*w+r*C)*N,t[6]=(_*T-d*R-g*v)*N,t[7]=(c*R-l*T+f*v)*N,t[8]=(s*O-a*w+u*S)*N,t[9]=(i*w-n*O-r*S)*N,t[10]=(d*b-m*T+g*y)*N,t[11]=(p*T-c*b-f*y)*N,t[12]=(a*C-s*I-h*S)*N,t[13]=(n*I-i*C+o*S)*N,t[14]=(m*v-d*E-_*y)*N,t[15]=(c*E-p*v+l*y)*N,t):null}function o(t,e,n){var i,o,r,s,a=e[0],h=e[1],u=e[2],c=e[3],p=e[4],l=e[5],f=e[6],d=e[7],m=e[8],_=e[9],g=e[10],y=e[11],v=e[12],T=e[13],E=e[14],b=e[15],R=n[0],S=n[1],C=n[2],w=n[3],I=n[4],O=n[5],A=n[6],N=n[7],L=n[8],M=n[9],D=n[10],U=n[11],P=n[12],x=n[13],z=n[14],F=n[15],H=!1;return i=R*a+S*p+C*m+w*v,o=R*h+S*l+C*_+w*T,r=R*u+S*f+C*g+w*E,s=R*c+S*d+C*y+w*b,H=H?H:i===t[0]||o===t[1]||r===t[2]||s===t[3],t[0]=i,t[1]=o,t[2]=r,t[3]=s,R=I,S=O,C=A,w=N,i=R*a+S*p+C*m+w*v,o=R*h+S*l+C*_+w*T,r=R*u+S*f+C*g+w*E,s=R*c+S*d+C*y+w*b,H=H?H:i===t[4]||o===t[5]||r===t[6]||s===t[7],t[4]=i,t[5]=o,t[6]=r,t[7]=s,R=L,S=M,C=D,w=U,i=R*a+S*p+C*m+w*v,o=R*h+S*l+C*_+w*T,r=R*u+S*f+C*g+w*E,s=R*c+S*d+C*y+w*b,H=H?H:i===t[8]||o===t[9]||r===t[10]||s===t[11],t[8]=i,t[9]=o,t[10]=r,t[11]=s,R=P,S=x,C=z,w=F,i=R*a+S*p+C*m+w*v,o=R*h+S*l+C*_+w*T,r=R*u+S*f+C*g+w*E,s=R*c+S*d+C*y+w*b,H=H?H:i===t[12]||o===t[13]||r===t[14]||s===t[15],t[12]=i,t[13]=o,t[14]=r,t[15]=s,t}e.exports={multiply:o,invert:i}},{}],20:[function(t,e,n){"use strict";var i={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};e.exports=i},{}],21:[function(t,e,n){"use strict";function i(t){o.call(this,t),this.data=t.data}var o=t("./UIEvent");i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"CompositionEvent"},e.exports=i},{"./UIEvent":29}],22:[function(t,e,n){"use strict";function i(t){this.type=t.type,this.defaultPrevented=t.defaultPrevented,this.timeStamp=t.timeStamp;var e=t.target.constructor;(e===HTMLInputElement||e===HTMLTextAreaElement||e===HTMLSelectElement)&&(this.value=t.target.value)}i.prototype.toString=function(){return"Event"},e.exports=i},{}],23:[function(t,e,n){"use strict";var i=t("./CompositionEvent"),o=t("./Event"),r=t("./FocusEvent"),s=t("./InputEvent"),a=t("./KeyboardEvent"),h=t("./MouseEvent"),u=t("./TouchEvent"),c=t("./UIEvent"),p=t("./WheelEvent"),l={change:[o,!0],submit:[o,!0],abort:[o,!1],beforeinput:[s,!0],blur:[r,!1],click:[h,!0],compositionend:[i,!0],compositionstart:[i,!0],compositionupdate:[i,!0],dblclick:[h,!0],focus:[r,!1],focusin:[r,!0],focusout:[r,!0],input:[s,!0],keydown:[a,!0],keyup:[a,!0],load:[o,!1],mousedown:[h,!0],mouseenter:[h,!1],mouseleave:[h,!1],mousemove:[h,!1],mouseout:[h,!0],mouseover:[h,!0],mouseup:[h,!0],resize:[c,!1],scroll:[c,!1],select:[o,!0],unload:[o,!1],wheel:[p,!0],touchcancel:[u,!0],touchend:[u,!0],touchmove:[u,!0],touchstart:[u,!0]};e.exports=l},{"./CompositionEvent":21,"./Event":22,"./FocusEvent":24,"./InputEvent":25,"./KeyboardEvent":26,"./MouseEvent":27,
"./TouchEvent":28,"./UIEvent":29,"./WheelEvent":30}],24:[function(t,e,n){"use strict";function i(t){o.call(this,t)}var o=t("./UIEvent");i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"FocusEvent"},e.exports=i},{"./UIEvent":29}],25:[function(t,e,n){"use strict";function i(t){o.call(this,t),this.inputType=t.inputType,this.data=t.data,this.isComposing=t.isComposing,this.targetRange=t.targetRange}var o=t("./UIEvent");i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"InputEvent"},e.exports=i},{"./UIEvent":29}],26:[function(t,e,n){"use strict";function i(t){o.call(this,t),this.DOM_KEY_LOCATION_STANDARD=0,this.DOM_KEY_LOCATION_LEFT=1,this.DOM_KEY_LOCATION_RIGHT=2,this.DOM_KEY_LOCATION_NUMPAD=3,this.key=t.key,this.code=t.code,this.location=t.location,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.repeat=t.repeat,this.isComposing=t.isComposing,this.keyCode=t.keyCode}var o=t("./UIEvent");i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"KeyboardEvent"},e.exports=i},{"./UIEvent":29}],27:[function(t,e,n){"use strict";function i(t){o.call(this,t),this.screenX=t.screenX,this.screenY=t.screenY,this.clientX=t.clientX,this.clientY=t.clientY,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.button=t.button,this.buttons=t.buttons,this.pageX=t.pageX,this.pageY=t.pageY,this.x=t.x,this.y=t.y,this.offsetX=t.offsetX,this.offsetY=t.offsetY}var o=t("./UIEvent");i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"MouseEvent"},e.exports=i},{"./UIEvent":29}],28:[function(t,e,n){"use strict";function i(t){this.identifier=t.identifier,this.screenX=t.screenX,this.screenY=t.screenY,this.clientX=t.clientX,this.clientY=t.clientY,this.pageX=t.pageX,this.pageY=t.pageY}function o(t){if(!t)return a;for(var e=[],n=0;n<t.length;n++)e[n]=new i(t[n]);return e}function r(t){s.call(this,t),this.touches=o(t.touches),this.targetTouches=o(t.targetTouches),this.changedTouches=o(t.changedTouches),this.altKey=t.altKey,this.metaKey=t.metaKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey}var s=t("./UIEvent"),a=[];r.prototype=Object.create(s.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return"TouchEvent"},e.exports=r},{"./UIEvent":29}],29:[function(t,e,n){"use strict";function i(t){o.call(this,t),this.detail=t.detail}var o=t("./Event");i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"UIEvent"},e.exports=i},{"./Event":22}],30:[function(t,e,n){"use strict";function i(t){o.call(this,t),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2,this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.deltaZ=t.deltaZ,this.deltaMode=t.deltaMode}var o=t("./MouseEvent");i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"WheelEvent"},e.exports=i},{"./MouseEvent":27}],31:[function(t,e,n){"use strict";var i,o,r=0,s=["ms","moz","webkit","o"];if("object"==typeof window){i=window.requestAnimationFrame,o=window.cancelAnimationFrame||window.cancelRequestAnimationFrame;for(var a=0;a<s.length&&!i;++a)i=window[s[a]+"RequestAnimationFrame"],o=window[s[a]+"CancelRequestAnimationFrame"]||window[s[a]+"CancelAnimationFrame"];i&&!o&&(i=null)}if(!i){var h=Date.now?Date.now:function(){return(new Date).getTime()};i=function(t){var e=h(),n=Math.max(0,16-(e-r)),i=setTimeout(function(){t(e+n)},n);return r=e+n,i},o=function(t){clearTimeout(t)}}var u={requestAnimationFrame:i,cancelAnimationFrame:o};e.exports=u},{}],32:[function(t,e,n){"use strict";e.exports={requestAnimationFrame:t("./animationFrame").requestAnimationFrame,cancelAnimationFrame:t("./animationFrame").cancelAnimationFrame}},{"./animationFrame":31}],33:[function(t,e,n){"use strict";function i(){var t=this;this._updates=[],this._looper=function(e){t.loop(e)},this._time=0,this._stoppedAt=0,this._sleep=0,this._startOnVisibilityChange=!0,this._rAF=null,this._sleepDiff=!0,this.start(),a&&document.addEventListener(u,function(){t._onVisibilityChange()})}var o=t("../polyfills"),r=o.requestAnimationFrame,s=o.cancelAnimationFrame,a="undefined"!=typeof document;if(a){var h,u;"undefined"!=typeof document.hidden?(h="hidden",u="visibilitychange"):"undefined"!=typeof document.mozHidden?(h="mozHidden",u="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(h="msHidden",u="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(h="webkitHidden",u="webkitvisibilitychange")}i.prototype._onVisibilityChange=function(){document[h]?this._onUnfocus():this._onFocus()},i.prototype._onFocus=function(){this._startOnVisibilityChange&&this._start()},i.prototype._onUnfocus=function(){this._stop()},i.prototype.start=function(){return this._running||(this._startOnVisibilityChange=!0,this._start()),this},i.prototype._start=function(){this._running=!0,this._sleepDiff=!0,this._rAF=r(this._looper)},i.prototype.stop=function(){return this._running&&(this._startOnVisibilityChange=!1,this._stop()),this},i.prototype._stop=function(){this._running=!1,this._stoppedAt=this._time,s(this._rAF)},i.prototype.isRunning=function(){return this._running},i.prototype.step=function(t){this._time=t,this._sleepDiff&&(this._sleep+=t-this._stoppedAt,this._sleepDiff=!1);for(var e=t-this._sleep,n=0,i=this._updates.length;i>n;n++)this._updates[n].update(e);return this},i.prototype.loop=function(t){return this.step(t),this._rAF=r(this._looper),this},i.prototype.update=function(t){return-1===this._updates.indexOf(t)&&this._updates.push(t),this},i.prototype.noLongerUpdate=function(t){var e=this._updates.indexOf(t);return e>-1&&this._updates.splice(e,1),this},e.exports=i},{"../polyfills":32}],34:[function(t,e,n){"use strict";function i(){r(),this._contexts={},this._outCommands=[],this._inCommands=[],this._time=null,this._resized=!1;var t=this;window.addEventListener("resize",function(){t.onResize()})}var o=t("./Context"),r=t("./inject-css"),s=t("../core/Commands");i.prototype.onResize=function(){this._resized=!0;for(var t in this._contexts)this._contexts[t].updateSize()},i.prototype.getTime=function(){return this._time},i.prototype.sendEvent=function(t,e,n){this._outCommands.push(s.WITH,t,s.TRIGGER,e,n)},i.prototype.sendResize=function(t,e){this.sendEvent(t,"CONTEXT_RESIZE",e)},i.prototype.handleWith=function(t,e){var n=e[t],i=n.split("/"),o=this.getOrSetContext(i.shift());return o.receive(n,e,t)},i.prototype.getOrSetContext=function(t){if(this._contexts[t])return this._contexts[t];var e=new o(t,this);return this._contexts[t]=e,e},i.prototype.getContext=function(t){return this._contexts[t]?this._contexts[t]:void 0},i.prototype.drawCommands=function(){for(var t=this._inCommands,e=0,n=t[e];n;){switch(n){case s.TIME:this._time=t[++e];break;case s.WITH:e=this.handleWith(++e,t);break;case s.NEED_SIZE_FOR:this.giveSizeFor(++e,t)}n=t[++e]}for(var i in this._contexts)this._contexts[i].draw();return this._resized&&this.updateSize(),this._outCommands},i.prototype.updateSize=function(){for(var t in this._contexts)this._contexts[t].updateSize()},i.prototype.receiveCommands=function(t){for(var e=t.length,n=0;e>n;n++)this._inCommands.push(t[n]);for(var i in this._contexts)this._contexts[i].checkInit()},i.prototype.giveSizeFor=function(t,e){var n=e[t],i=this.getOrSetContext(n).getRootSize();this.sendResize(n,i)},i.prototype.clearCommands=function(){this._inCommands.length=0,this._outCommands.length=0,this._resized=!1},e.exports=i},{"../core/Commands":4,"./Context":35,"./inject-css":37}],35:[function(t,e,n){"use strict";function i(t,e){if(this._compositor=e,this._rootEl=document.querySelector(t),this._selector=t,null===this._rootEl)throw new Error('Failed to create Context: No matches for "'+t+'" found.');this._selector=t,this._initDOMRenderer(),this._webGLRenderer=null,this._domRenderer=new D(this._domRendererRootEl,t,e),this._canvasEl=null,this._renderState={projectionType:M.ORTHOGRAPHIC_PROJECTION,perspectiveTransform:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),viewTransform:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),viewDirty:!1,perspectiveDirty:!1},this._size=[],this._meshTransform=new Float32Array(16),this._meshSize=[0,0,0],this._initDOM=!1,this._commandCallbacks=[],this.initCommandCallbacks(),this.updateSize()}function o(t,e,n,i){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.preventDefault(n[++i]),i}function r(t,e,n,i){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.allowDefault(n[++i]),i}function s(t,e,n,i){return t._initDOM=!0,i}function a(t,e,n,i){return t._domRenderer.insertEl(n[++i]),i}function h(t,e,n,i){return t._domRenderer.getSizeOf(n[++i]),i}function u(t,e,n,i){var o=t._meshTransform;return o[0]=n[++i],o[1]=n[++i],o[2]=n[++i],o[3]=n[++i],o[4]=n[++i],o[5]=n[++i],o[6]=n[++i],o[7]=n[++i],o[8]=n[++i],o[9]=n[++i],o[10]=n[++i],o[11]=n[++i],o[12]=n[++i],o[13]=n[++i],o[14]=n[++i],o[15]=n[++i],t._domRenderer.setMatrix(o),t._webGLRenderer&&t._webGLRenderer.setCutoutUniform(e,"u_transform",o),i}function c(t,e,n,i){var o=n[++i],r=n[++i];return t._domRenderer.setSize(o,r),t._webGLRenderer&&(t._meshSize[0]=o,t._meshSize[1]=r,t._webGLRenderer.setCutoutUniform(e,"u_size",t._meshSize)),i}function p(t,e,n,i){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.setProperty(n[++i],n[++i]),i}function l(t,e,n,i){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.setContent(n[++i]),i}function f(t,e,n,i){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.setAttribute(n[++i],n[++i]),i}function d(t,e,n,i){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.addClass(n[++i]),i}function m(t,e,n,i){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.removeClass(n[++i]),i}function _(t,e,n,i){return t._webGLRenderer&&t._webGLRenderer.getOrSetCutout(e),t._domRenderer.subscribe(n[++i]),i}function g(t,e,n,i){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setMeshOptions(e,n[++i]),i}function y(t,e,n,i){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setAmbientLightColor(e,n[++i],n[++i],n[++i]),i}function v(t,e,n,i){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setLightPosition(e,n[++i],n[++i],n[++i]),i}function T(t,e,n,i){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setLightColor(e,n[++i],n[++i],n[++i]),i}function E(t,e,n,i){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.handleMaterialInput(e,n[++i],n[++i]),i}function b(t,e,n,i){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setGeometry(e,n[++i],n[++i],n[++i]),i}function R(t,e,n,i){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setMeshUniform(e,n[++i],n[++i]),i}function S(t,e,n,i){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.bufferData(e,n[++i],n[++i],n[++i],n[++i],n[++i]),i}function C(t,e,n,i){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setCutoutState(e,n[++i]),i}function w(t,e,n,i){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.setMeshVisibility(e,n[++i]),i}function I(t,e,n,i){return t._webGLRenderer||t._initWebGLRenderer(),t._webGLRenderer.removeMesh(e),i}function O(t,e,n,i){return t._renderState.projectionType=M.PINHOLE_PROJECTION,t._renderState.perspectiveTransform[11]=-1/n[++i],t._renderState.perspectiveDirty=!0,i}function A(t,e,n,i){return t._renderState.projectionType=M.ORTHOGRAPHIC_PROJECTION,t._renderState.perspectiveTransform[11]=0,t._renderState.perspectiveDirty=!0,i}function N(t,e,n,i){return t._renderState.viewTransform[0]=n[++i],t._renderState.viewTransform[1]=n[++i],t._renderState.viewTransform[2]=n[++i],t._renderState.viewTransform[3]=n[++i],t._renderState.viewTransform[4]=n[++i],t._renderState.viewTransform[5]=n[++i],t._renderState.viewTransform[6]=n[++i],t._renderState.viewTransform[7]=n[++i],t._renderState.viewTransform[8]=n[++i],t._renderState.viewTransform[9]=n[++i],t._renderState.viewTransform[10]=n[++i],t._renderState.viewTransform[11]=n[++i],t._renderState.viewTransform[12]=n[++i],t._renderState.viewTransform[13]=n[++i],t._renderState.viewTransform[14]=n[++i],t._renderState.viewTransform[15]=n[++i],t._renderState.viewDirty=!0,i}var L=t("../webgl-renderers/WebGLRenderer"),M=t("../components/Camera"),D=t("../dom-renderers/DOMRenderer"),U=t("../core/Commands");i.prototype.updateSize=function(){var t=this._rootEl.offsetWidth,e=this._rootEl.offsetHeight;return this._size[0]=t,this._size[1]=e,this._size[2]=t>e?t:e,this._compositor.sendResize(this._selector,this._size),this._webGLRenderer&&this._webGLRenderer.updateSize(this._size),this},i.prototype.draw=function(){this._domRenderer.draw(this._renderState),this._webGLRenderer&&this._webGLRenderer.draw(this._renderState),this._renderState.perspectiveDirty&&(this._renderState.perspectiveDirty=!1),this._renderState.viewDirty&&(this._renderState.viewDirty=!1)},i.prototype._initDOMRenderer=function(){this._domRendererRootEl=document.createElement("div"),this._rootEl.appendChild(this._domRendererRootEl),this._domRendererRootEl.style.display="none",this._domRenderer=new D(this._domRendererRootEl,this._selector,this._compositor)},i.prototype.getRootSize=function(){return[this._rootEl.offsetWidth,this._rootEl.offsetHeight]},i.prototype.initCommandCallbacks=function(){this._commandCallbacks[U.INIT_DOM]=a,this._commandCallbacks[U.DOM_RENDER_SIZE]=h,this._commandCallbacks[U.CHANGE_TRANSFORM]=u,this._commandCallbacks[U.CHANGE_SIZE]=c,this._commandCallbacks[U.CHANGE_PROPERTY]=p,this._commandCallbacks[U.CHANGE_CONTENT]=l,this._commandCallbacks[U.CHANGE_ATTRIBUTE]=f,this._commandCallbacks[U.ADD_CLASS]=d,this._commandCallbacks[U.REMOVE_CLASS]=m,this._commandCallbacks[U.SUBSCRIBE]=_,this._commandCallbacks[U.GL_SET_DRAW_OPTIONS]=g,this._commandCallbacks[U.GL_AMBIENT_LIGHT]=y,this._commandCallbacks[U.GL_LIGHT_POSITION]=v,this._commandCallbacks[U.GL_LIGHT_COLOR]=T,this._commandCallbacks[U.MATERIAL_INPUT]=E,this._commandCallbacks[U.GL_SET_GEOMETRY]=b,this._commandCallbacks[U.GL_UNIFORMS]=R,this._commandCallbacks[U.GL_BUFFER_DATA]=S,this._commandCallbacks[U.GL_CUTOUT_STATE]=C,this._commandCallbacks[U.GL_MESH_VISIBILITY]=w,this._commandCallbacks[U.GL_REMOVE_MESH]=I,this._commandCallbacks[U.PINHOLE_PROJECTION]=O,this._commandCallbacks[U.ORTHOGRAPHIC_PROJECTION]=A,this._commandCallbacks[U.CHANGE_VIEW_TRANSFORM]=N,this._commandCallbacks[U.PREVENT_DEFAULT]=o,this._commandCallbacks[U.ALLOW_DEFAULT]=r,this._commandCallbacks[U.READY]=s},i.prototype._initWebGLRenderer=function(){this._webGLRendererRootEl=document.createElement("canvas"),this._rootEl.appendChild(this._webGLRendererRootEl),this._webGLRenderer=new L(this._webGLRendererRootEl,this._compositor),this._webGLRenderer.updateSize(this._size)},i.prototype.getRootSize=function(){return[this._rootEl.offsetWidth,this._rootEl.offsetHeight]},i.prototype.checkInit=function(){this._initDOM&&(this._domRendererRootEl.style.display="block",this._initDOM=!1)},i.prototype.receive=function(t,e,n){var i=n,o=e[++i];for(this._domRenderer.loadPath(t),this._domRenderer.findTarget();null!=o;){if(o===U.WITH||o===U.TIME)return i-1;i=this._commandCallbacks[o](this,t,e,i)+1,o=e[i]}return i},i.prototype.getDOMRenderer=function(){return this._domRenderer},i.prototype.getWebGLRenderer=function(){return this._webGLRenderer},e.exports=i},{"../components/Camera":1,"../core/Commands":4,"../dom-renderers/DOMRenderer":17,"../webgl-renderers/WebGLRenderer":50}],36:[function(t,e,n){"use strict";function i(t,e,n){this._thread=t,this._compositor=e,this._renderLoop=n,this._renderLoop.update(this);var i=this;this._thread.onmessage=function(t){var e=t.data?t.data:t;if(e[0]===o.ENGINE)switch(e[1]){case o.START:i._engine.start();break;case o.STOP:i._engine.stop();break;default:console.error('Unknown ENGINE command "'+e[1]+'"')}else i._compositor.receiveCommands(e)},this._thread.onerror=function(t){console.error(t)}}var o=t("../core/Commands");i.prototype.getThread=function(){return this._thread},i.prototype.getCompositor=function(){return this._compositor},i.prototype.getEngine=function(){return this._renderLoop},i.prototype.getRenderLoop=function(){return this._renderLoop},i.prototype.update=function(t){this._thread.postMessage([o.FRAME,t]);var e=this._compositor.drawCommands();this._thread.postMessage(e),this._compositor.clearCommands()},e.exports=i},{"../core/Commands":4}],37:[function(t,e,n){"use strict";function i(){if(!r)if(r=!0,document.createStyleSheet){var t=document.createStyleSheet();t.cssText=o}else{var e=document.getElementsByTagName("head")[0],n=document.createElement("style");n.styleSheet?n.styleSheet.cssText=o:n.appendChild(document.createTextNode(o)),(e?e:document.documentElement).appendChild(n)}}var o=".famous-dom-renderer {width:100%;height:100%;transform-style:preserve-3d;-webkit-transform-style:preserve-3d;}.famous-dom-element {-webkit-transform-origin:0% 0%;transform-origin:0% 0%;-webkit-backface-visibility:visible;backface-visibility:visible;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;-webkit-tap-highlight-color:transparent;pointer-events:auto;z-index:1;}.famous-dom-element-content,.famous-dom-element {position:absolute;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;}.famous-webgl-renderer {-webkit-transform:translateZ(1000000px);transform:translateZ(1000000px);pointer-events:none;position:absolute;z-index:1;top:0;width:100%;height:100%;}",r="undefined"==typeof document;e.exports=i},{}],38:[function(t,e,n){"use strict";var i={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t},inQuad:function(t){return t*t},outQuad:function(t){return-(t-=1)*t+1},inOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},inQuart:function(t){return t*t*t*t},outQuart:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return--t*t*t*t*t+1},inOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},inSine:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},outExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:1===t?1:(n||(n=.3),e=n/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)))},outElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:1===t?1:(n||(n=.3),e=n/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/n)+1)},inOutElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:2===(t/=.5)?1:(n||(n=.3*1.5),e=n/(2*Math.PI)*Math.asin(1/i),1>t?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)):i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1)},inBack:function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)},outBack:function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1},inOutBack:function(t,e){return void 0===e&&(e=1.70158),(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},inBounce:function(t){return 1-i.outBounce(1-t)},outBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t){return.5>t?.5*i.inBounce(2*t):.5*i.outBounce(2*t-1)+.5},flat:function(){return 0}};e.exports=i},{}],39:[function(t,e,n){"use strict";function i(t){this._queue=[],this._from=null,this._state=null,this._startedAt=null,this._pausedAt=null,null!=t&&this.from(t)}var o=t("./Curves"),r=t("../core/FamousEngine");i.Clock=r.getClock(),i.prototype.to=function(t,e,n,i,r){return e=null!=e&&e.constructor===String?o[e]:e,0===this._queue.length&&(this._startedAt=this.constructor.Clock.now(),this._pausedAt=null),this._queue.push(t,null!=e?e:o.linear,null!=n?n:100,i,r),this},i.prototype.from=function(t){return this._state=t,this._from=this._sync(null,this._state),this._queue.length=0,this._startedAt=this.constructor.Clock.now(),this._pausedAt=null,this},i.prototype.delay=function(t,e){var n=this._queue.length>0?this._queue[this._queue.length-5]:this._state;return this.to(n,o.flat,t,e)},i.prototype.override=function(t,e,n,i,r){return this._queue.length>0&&(null!=t&&(this._queue[0]=t),null!=e&&(this._queue[1]=e.constructor===String?o[e]:e),null!=n&&(this._queue[2]=n),null!=i&&(this._queue[3]=i),null!=r&&(this._queue[4]=r)),this},i.prototype._interpolate=function(t,e,n,i,o){if(n instanceof Object)if("slerp"===o){var r,s,a,h,u,c,p,l,f,d,m,_,g;if(r=e[0],s=e[1],a=e[2],h=e[3],u=n[0],c=n[1],p=n[2],l=n[3],1===i)return t[0]=u,t[1]=c,t[2]=p,t[3]=l,t;d=h*l+r*u+s*c+a*p,1-d>1e-5?(f=Math.acos(d),m=Math.sin(f),_=Math.sin((1-i)*f)/m,g=Math.sin(i*f)/m):(_=1-i,g=i),t[0]=r*_+u*g,t[1]=s*_+c*g,t[2]=a*_+p*g,t[3]=h*_+l*g}else if(n instanceof Array)for(var y=0,v=n.length;v>y;y++)t[y]=this._interpolate(t[y],e[y],n[y],i,o);else for(var T in n)t[T]=this._interpolate(t[T],e[T],n[T],i,o);else t=e+i*(n-e);return t},i.prototype._sync=function t(e,n){if("number"==typeof n)e=n;else if(n instanceof Array){null==e&&(e=[]);for(var i=0,o=n.length;o>i;i++)e[i]=t(e[i],n[i])}else if(n instanceof Object){null==e&&(e={});for(var r in n)e[r]=t(e[r],n[r])}return e},i.prototype.get=function(t){if(0===this._queue.length)return this._state;t=this._pausedAt?this._pausedAt:t,t=t?t:this.constructor.Clock.now();var e=(t-this._startedAt)/this._queue[2];this._state=this._interpolate(this._state,this._from,this._queue[0],this._queue[1](e>1?1:e),this._queue[4]);var n=this._state;if(e>=1){this._startedAt=this._startedAt+this._queue[2],this._from=this._sync(this._from,this._state),this._queue.shift(),this._queue.shift(),this._queue.shift();var i=this._queue.shift();this._queue.shift(),i&&i()}return e>1?this.get():n},i.prototype.isActive=function(){return this._queue.length>0},i.prototype.halt=function(){return this.from(this.get())},i.prototype.pause=function(){return this._pausedAt=this.constructor.Clock.now(),this},i.prototype.isPaused=function(){return!!this._pausedAt},i.prototype.resume=function(){var t=this._pausedAt-this._startedAt;return this._startedAt=this.constructor.Clock.now()-t,this._pausedAt=null,this},i.prototype.reset=function(t){return this.from(t)},i.prototype.set=function(t,e,n){return null==e?(this.from(t),n&&n()):this.to(t,e.curve,e.duration,n,e.method),this},e.exports=i},{"../core/FamousEngine":7,"./Curves":38}],40:[function(t,e,n){"use strict";function i(){this._events={}}i.prototype.on=function(t,e){this._events[t]||(this._events[t]=[]);var n=this._events[t];return n.push(e),function(){n.splice(n.indexOf(e),1)}},i.prototype.off=function(t,e){var n=this._events[t];return n&&n.splice(n.indexOf(e),1),this},i.prototype.trigger=function(t,e){var n=this._events[t];if(n)for(var i=0,o=n.length;o>i;i++)n[i](e);return this},e.exports=i},{}],41:[function(t,e,n){"use strict";var i=function t(e){var n;if("object"==typeof e){n=e instanceof Array?[]:{};for(var i in e)if("object"==typeof e[i]&&null!==e[i])if(e[i]instanceof Array){n[i]=new Array(e[i].length);for(var o=0;o<e[i].length;o++)n[i][o]=t(e[i][o])}else n[i]=t(e[i]);else n[i]=e[i]}else n=e;return n};e.exports=i},{}],42:[function(t,e,n){"use strict";e.exports=function(t){var e=[],n=[],i=0;for(var o in t)t.hasOwnProperty(o)&&(e[i]=o,n[i]=t[o],i++);return{keys:e,values:n}}},{}],43:[function(t,e,n){"use strict";function i(t){for(var e=0;e<o.length;e++){var n=o[e]+t;if(""===document.documentElement.style[n])return n}return t}var o=["","-ms-","-webkit-","-moz-","-o-"];e.exports=i},{}],44:[function(t,e,n){"use strict";function i(t,e,n){this.buffer=null,this.target=t,this.type=e,this.data=[],this.gl=n}i.prototype.subData=function(){for(var t=this.gl,e=[],n=0,i=1e4;n<this.data.length;n+=i)e=Array.prototype.concat.apply(e,this.data.slice(n,n+i));this.buffer=this.buffer||t.createBuffer(),t.bindBuffer(this.target,this.buffer),t.bufferData(this.target,new this.type(e),t.STATIC_DRAW)},e.exports=i},{}],45:[function(t,e,n){"use strict";function i(t){this.gl=t,this.registry={},this._dynamicBuffers=[],this._staticBuffers=[],this._arrayBufferMax=3e4,this._elementBufferMax=3e4}var o="indices",r=t("./Buffer");i.prototype.allocate=function(t,e,n,i,s){var a,h,u,c,p=this.registry[t]||(this.registry[t]={keys:[],values:[],spacing:[],offset:[],length:[]}),l=p.keys.indexOf(e),f=e===o,d=!1,m=0;if(-1===l){if(l=p.keys.length,h=f?n.length:Math.floor(n.length/i),s)u=new r(f?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,f?Uint16Array:Float32Array,this.gl),this._dynamicBuffers.push({buffer:u,offset:n.length,isIndex:f});else{for(c=0;c<this._staticBuffers.length;c++)if(f===this._staticBuffers[c].isIndex&&(a=this._staticBuffers[c].offset+n.length,!f&&a<this._arrayBufferMax||f&&a<this._elementBufferMax)){u=this._staticBuffers[c].buffer,m=this._staticBuffers[c].offset,this._staticBuffers[c].offset+=n.length,d=!0;break}d||(u=new r(f?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,f?Uint16Array:Float32Array,this.gl),this._staticBuffers.push({buffer:u,offset:n.length,isIndex:f}))}p.keys.push(e),p.values.push(u),p.spacing.push(i),p.offset.push(m),p.length.push(h)}var _=n.length;for(c=0;_>c;c++)p.values[l].data[m+c]=n[c];p.values[l].subData()},e.exports=i},{"./Buffer":44}],46:[function(t,e,n){"use strict";function i(t,e){return function(){var n=t.apply(this,arguments);return e.apply(this,arguments),n}}function o(t,e){var n="body,html{background:#e3e3e3;font-family:monaco,monospace;font-size:14px;line-height:1.7em}#shaderReport{left:0;top:0;right:0;box-sizing:border-box;position:absolute;z-index:1000;color:#222;padding:15px;white-space:normal;list-style-type:none;margin:50px auto;max-width:1200px}#shaderReport li{background-color:#fff;margin:13px 0;box-shadow:0 1px 2px rgba(0,0,0,.15);padding:20px 30px;border-radius:2px;border-left:20px solid #e01111}span{color:#e01111;text-decoration:underline;font-weight:700}#shaderReport li p{padding:0;margin:0}#shaderReport li:nth-child(even){background-color:#f4f4f4}#shaderReport li p:first-child{margin-bottom:10px;color:#666}",i=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(i),i.textContent=n;var o=document.createElement("ul");o.setAttribute("id","shaderReport"),document.body.appendChild(o);for(var r,s=/ERROR: [\d]+:([\d]+): (.+)/gim,a=e.split("\n");null!=(r=s.exec(t));){r.index===s.lastIndex&&s.lastIndex++;var h=document.createElement("li"),u='<p><span>ERROR</span> "'+r[2]+'" in line '+r[1]+"</p>";u+="<p><b>"+a[r[1]-1].replace(/^[ \t]+/g,"")+"</b></p>",h.innerHTML=u,o.appendChild(h)}}e.exports=function(){return i(this.gl.compileShader,function(t){if(!this.getShaderParameter(t,this.COMPILE_STATUS)){var e=this.getShaderInfoLog(t),n=this.getShaderSource(t);o(e,n)}})}},{}],47:[function(t,e,n){"use strict";function i(t,e){this.gl=t,this.textureSlots=1,this.options=e||{},this.registeredMaterials={},this.flaggedUniforms=[],this.cachedUniforms={},this.uniformTypes=[],this.definitionVec4=[],this.definitionVec3=[],this.definitionFloat=[],this.applicationVec3=[],this.applicationVec4=[],this.applicationFloat=[],this.applicationVert=[],this.definitionVert=[],this.resetProgram()}var o=t("../utilities/clone"),r=t("../utilities/keyValueToArrays"),s=t("../webgl-shaders").vertex,a=t("../webgl-shaders").fragment,h=t("./Debug"),u=35633,c=35632,p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l="precision mediump float;\n",f={undefined:"float ",1:"float ",2:"vec2 ",3:"vec3 ",4:"vec4 ",16:"mat4 "},d={u_baseColor:"vec4",u_normals:"vert",u_glossiness:"vec4",u_positionOffset:"vert"},m={vert:1,vec3:2,vec4:4,float:8},_=r({u_perspective:p,u_view:p,u_resolution:[0,0,0],u_transform:p,u_size:[1,1,1],u_time:0,u_opacity:1,u_metalness:0,u_glossiness:[0,0,0,0],u_baseColor:[1,1,1,1],u_normals:[1,1,1],u_positionOffset:[0,0,0],u_lightPosition:p,u_lightColor:p,u_ambientLight:[0,0,0],u_flatShading:0,u_numLights:0}),g=r({a_pos:[0,0,0],a_texCoord:[0,0],a_normals:[0,0,0]}),y=r({v_textureCoordinate:[0,0],v_normal:[0,0,0],v_position:[0,0,0],v_eyeVector:[0,0,0]});i.prototype.registerMaterial=function(t,e){var n=e,i=d[t],o=m[i];if((this.registeredMaterials[e._id]&o)===o)return this;var r;for(r in n.uniforms)-1===_.keys.indexOf(r)&&(_.keys.push(r),_.values.push(n.uniforms[r]));for(r in n.varyings)-1===y.keys.indexOf(r)&&(y.keys.push(r),y.values.push(n.varyings[r]));for(r in n.attributes)-1===g.keys.indexOf(r)&&(g.keys.push(r),g.values.push(n.attributes[r]));return this.registeredMaterials[e._id]|=o,"float"===i&&(this.definitionFloat.push(e.defines),this.definitionFloat.push("float fa_"+e._id+"() {\n "+n.glsl+" \n}"),this.applicationFloat.push("if (int(abs(ID)) == "+e._id+") return fa_"+e._id+"();")),"vec3"===i&&(this.definitionVec3.push(e.defines),this.definitionVec3.push("vec3 fa_"+e._id+"() {\n "+n.glsl+" \n}"),this.applicationVec3.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),"vec4"===i&&(this.definitionVec4.push(e.defines),this.definitionVec4.push("vec4 fa_"+e._id+"() {\n "+n.glsl+" \n}"),this.applicationVec4.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),"vert"===i&&(this.definitionVert.push(e.defines),this.definitionVert.push("vec3 fa_"+e._id+"() {\n "+n.glsl+" \n}"),this.applicationVert.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),this.resetProgram()},i.prototype.resetProgram=function(){var t,e,n,i,r,h,p=[l],d=[l];for(this.uniformLocations=[],this.attributeLocations={},this.uniformTypes={},this.attributeNames=o(g.keys),this.attributeValues=o(g.values),this.varyingNames=o(y.keys),this.varyingValues=o(y.values),this.uniformNames=o(_.keys),this.uniformValues=o(_.values),this.flaggedUniforms=[],this.cachedUniforms={},d.push("uniform sampler2D u_textures[7];\n"),this.applicationVert.length&&p.push("uniform sampler2D u_textures[7];\n"),h=0;h<this.uniformNames.length;h++)i=this.uniformNames[h],r=this.uniformValues[h],p.push("uniform "+f[r.length]+i+";\n"),d.push("uniform "+f[r.length]+i+";\n");for(h=0;h<this.attributeNames.length;h++)i=this.attributeNames[h],r=this.attributeValues[h],p.push("attribute "+f[r.length]+i+";\n");for(h=0;h<this.varyingNames.length;h++)i=this.varyingNames[h],r=this.varyingValues[h],p.push("varying "+f[r.length]+i+";\n"),d.push("varying "+f[r.length]+i+";\n");e=p.join("")+s.replace("#vert_definitions",this.definitionVert.join("\n")).replace("#vert_applications",this.applicationVert.join("\n")),t=d.join("")+a.replace("#vec3_definitions",this.definitionVec3.join("\n")).replace("#vec3_applications",this.applicationVec3.join("\n")).replace("#vec4_definitions",this.definitionVec4.join("\n")).replace("#vec4_applications",this.applicationVec4.join("\n")).replace("#float_definitions",this.definitionFloat.join("\n")).replace("#float_applications",this.applicationFloat.join("\n")),n=this.gl.createProgram(),this.gl.attachShader(n,this.compileShader(this.gl.createShader(u),e)),this.gl.attachShader(n,this.compileShader(this.gl.createShader(c),t)),this.gl.linkProgram(n),this.gl.getProgramParameter(n,this.gl.LINK_STATUS)?(this.program=n,this.gl.useProgram(this.program)):(console.error("link error: "+this.gl.getProgramInfoLog(n)),
this.program=null),this.setUniforms(this.uniformNames,this.uniformValues);var m=this.gl.getUniformLocation(this.program,"u_textures[0]");return this.gl.uniform1iv(m,[0,1,2,3,4,5,6]),this},i.prototype.uniformIsCached=function(t,e){if(null==this.cachedUniforms[t])return e.length?this.cachedUniforms[t]=new Float32Array(e):this.cachedUniforms[t]=e,!1;if(e.length){for(var n=e.length;n--;)if(e[n]!==this.cachedUniforms[t][n]){for(n=e.length;n--;)this.cachedUniforms[t][n]=e[n];return!1}}else if(this.cachedUniforms[t]!==e)return this.cachedUniforms[t]=e,!1;return!0},i.prototype.setUniforms=function(t,e){var n,i,o,r,s,a=this.gl;if(!this.program)return this;for(r=t.length,s=0;r>s;s++)if(o=t[s],i=e[s],n=this.uniformLocations[o],null!==n&&(void 0===n&&(n=a.getUniformLocation(this.program,o),this.uniformLocations[o]=n),!this.uniformIsCached(o,i)))switch(this.uniformTypes[o]||(this.uniformTypes[o]=this.getUniformTypeFromValue(i)),this.uniformTypes[o]){case"uniform4fv":a.uniform4fv(n,i);break;case"uniform3fv":a.uniform3fv(n,i);break;case"uniform2fv":a.uniform2fv(n,i);break;case"uniform1fv":a.uniform1fv(n,i);break;case"uniform1f":a.uniform1f(n,i);break;case"uniformMatrix3fv":a.uniformMatrix3fv(n,!1,i);break;case"uniformMatrix4fv":a.uniformMatrix4fv(n,!1,i)}return this},i.prototype.getUniformTypeFromValue=function(t){if(Array.isArray(t)||t instanceof Float32Array)switch(t.length){case 1:return"uniform1fv";case 2:return"uniform2fv";case 3:return"uniform3fv";case 4:return"uniform4fv";case 9:return"uniformMatrix3fv";case 16:return"uniformMatrix4fv"}else if(!isNaN(parseFloat(t))&&isFinite(t))return"uniform1f";throw'cant load uniform "'+name+'" with value:'+JSON.stringify(t)},i.prototype.compileShader=function(t,e){var n=1;return this.options.debug&&(this.gl.compileShader=h.call(this)),this.gl.shaderSource(t,e),this.gl.compileShader(t),this.gl.getShaderParameter(t,this.gl.COMPILE_STATUS)||(console.error("compile error: "+this.gl.getShaderInfoLog(t)),console.error("1: "+e.replace(/\n/g,function(){return"\n"+(n+=1)+": "}))),t},e.exports=i},{"../utilities/clone":41,"../utilities/keyValueToArrays":42,"../webgl-shaders":54,"./Debug":46}],48:[function(t,e,n){"use strict";function i(t,e){e=e||{},this.id=t.createTexture(),this.width=e.width||0,this.height=e.height||0,this.mipmap=e.mipmap,this.format=e.format||"RGBA",this.type=e.type||"UNSIGNED_BYTE",this.gl=t,this.bind(),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipYWebgl||!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlphaWebgl||!1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[e.magFilter]||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[e.minFilter]||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[e.wrapS]||t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[e.wrapT]||t.CLAMP_TO_EDGE)}i.prototype.bind=function(){return this.gl.bindTexture(this.gl.TEXTURE_2D,this.id),this},i.prototype.unbind=function(){return this.gl.bindTexture(this.gl.TEXTURE_2D,null),this},i.prototype.setImage=function(t){return this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl[this.format],this.gl[this.format],this.gl[this.type],t),this.mipmap&&this.gl.generateMipmap(this.gl.TEXTURE_2D),this},i.prototype.setArray=function(t){return this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl[this.format],this.width,this.height,0,this.gl[this.format],this.gl[this.type],t),this},i.prototype.readBack=function(t,e,n,i){var o,r=this.gl;t=t||0,e=e||0,n=n||this.width,i=i||this.height;var s=r.createFramebuffer();return r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.id,0),r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE&&(o=new Uint8Array(n*i*4),r.readPixels(t,e,n,i,r.RGBA,r.UNSIGNED_BYTE,o)),o},e.exports=i},{}],49:[function(t,e,n){"use strict";function i(t){this.registry=[],this._needsResample=[],this._activeTexture=0,this._boundTexture=null,this._checkerboard=s(),this.gl=t}function o(t,e){var n=("string"==typeof t?new Image:t)||{};return n.crossOrigin="anonymous",n.src||(n.src=t),n.complete?e(n):n.onload=function(){e(n)},n}var r=t("./Texture"),s=t("./createCheckerboard");i.prototype.update=function(t){for(var e=this.registry.length,n=1;e>n;n++){var i=this.registry[n];i&&i.isLoaded&&i.resampleRate&&(!i.lastResample||t-i.lastResample>i.resampleRate)&&(this._needsResample[i.id]||(this._needsResample[i.id]=!0,i.lastResample=t))}},i.prototype.register=function(t,e){var n,i=this,s=t.data,a=t.id,h=t.options||{},u=this.registry[a];return u||(u=new r(this.gl,h),u.setImage(this._checkerboard),n=this.registry[a]={resampleRate:h.resampleRate||null,lastResample:null,isLoaded:!1,texture:u,source:s,id:a,slot:e},Array.isArray(s)||s instanceof Uint8Array||s instanceof Float32Array?(this.bindTexture(a),u.setArray(s),n.isLoaded=!0):s instanceof HTMLVideoElement?s.addEventListener("loadeddata",function(){i.bindTexture(a),u.setImage(s),n.isLoaded=!0,n.source=s}):"string"==typeof s&&o(s,function(t){i.bindTexture(a),u.setImage(t),n.isLoaded=!0,n.source=t})),a},i.prototype.bindTexture=function(t){var e=this.registry[t];this._activeTexture!==e.slot&&(this.gl.activeTexture(this.gl.TEXTURE0+e.slot),this._activeTexture=e.slot),this._boundTexture!==t&&(this._boundTexture=t,e.texture.bind()),this._needsResample[e.id]&&(e.texture.setImage(e.source),this._needsResample[e.id]=!1)},e.exports=i},{"./Texture":48,"./createCheckerboard":52}],50:[function(t,e,n){"use strict";function i(t,e){t.classList.add("famous-webgl-renderer"),this.canvas=t,this.compositor=e;var n=this.gl=this.getWebGLContext(this.canvas);n.clearColor(0,0,0,0),n.polygonOffset(.1,.1),n.enable(n.POLYGON_OFFSET_FILL),n.enable(n.DEPTH_TEST),n.enable(n.BLEND),n.depthFunc(n.LEQUAL),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.enable(n.CULL_FACE),n.cullFace(n.BACK),this.meshRegistry={},this.meshRegistryKeys=[],this.cutoutRegistry={},this.cutoutRegistryKeys=[],this.numLights=0,this.ambientLightColor=[0,0,0],this.lightRegistry={},this.lightRegistryKeys=[],this.lightPositions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.lightColors=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.textureManager=new h(n),this.texCache={},this.bufferRegistry=new r(n),this.program=new o(n,{debug:!0}),this.state={boundArrayBuffer:null,boundElementBuffer:null,lastDrawn:null,enabledAttributes:{},enabledAttributesKeys:[]},this.resolutionName=["u_resolution"],this.resolutionValues=[[0,0,0]],this.cachedSize=[],this.projectionTransform=[1,0,0,0,0,1,0,0,0,0,-1e-6,0,-1,1,0,1];var i=this.cutoutGeometry={spec:{id:-1,bufferValues:[[-1,-1,0,1,-1,0,-1,1,0,1,1,0]],bufferNames:["a_pos"],type:"TRIANGLE_STRIP"}};this.bufferRegistry.allocate(this.cutoutGeometry.spec.id,i.spec.bufferNames[0],i.spec.bufferValues[0],3)}var o=t("./Program"),r=t("./BufferRegistry"),s=t("./radixSort"),a=t("../utilities/keyValueToArrays"),h=t("./TextureManager"),u=t("./compileMaterial"),c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p=a({u_numLights:0,u_ambientLight:new Array(3),u_lightPosition:new Array(3),u_lightColor:new Array(3),u_perspective:new Array(16),u_time:0,u_view:new Array(16)});i.prototype.getWebGLContext=function(t){for(var e,n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],i=0,o=n.length;o>i;i++){try{e=t.getContext(n[i])}catch(t){console.error("Error creating WebGL context: "+t.toString())}if(e)return e}return e?void 0:(console.error("Could not retrieve WebGL context. Please refer to https://www.khronos.org/webgl/ for requirements"),!1)},i.prototype.createLight=function(t){return this.numLights++,this.lightRegistryKeys.push(t),this.lightRegistry[t]={color:[0,0,0],position:[0,0,0]},this.lightRegistry[t]},i.prototype.createMesh=function(t){this.meshRegistryKeys.push(t);var e=a({u_opacity:1,u_transform:c,u_size:[0,0,0],u_baseColor:[.5,.5,.5,1],u_positionOffset:[0,0,0],u_normals:[0,0,0],u_flatShading:0,u_glossiness:[0,0,0,0]});return this.meshRegistry[t]={depth:null,uniformKeys:e.keys,uniformValues:e.values,buffers:{},geometry:null,drawType:null,textures:[],visible:!0},this.meshRegistry[t]},i.prototype.setCutoutState=function(t,e){var n=this.getOrSetCutout(t);n.visible=e},i.prototype.getOrSetCutout=function(t){if(this.cutoutRegistry[t])return this.cutoutRegistry[t];var e=a({u_opacity:0,u_transform:c.slice(),u_size:[0,0,0],u_origin:[0,0,0],u_baseColor:[0,0,0,1]});return this.cutoutRegistryKeys.push(t),this.cutoutRegistry[t]={uniformKeys:e.keys,uniformValues:e.values,geometry:this.cutoutGeometry.spec.id,drawType:this.cutoutGeometry.spec.type,visible:!0},this.cutoutRegistry[t]},i.prototype.setMeshVisibility=function(t,e){var n=this.meshRegistry[t]||this.createMesh(t);n.visible=e},i.prototype.removeMesh=function(t){var e=this.meshRegistryKeys.indexOf(t);this.meshRegistryKeys.splice(e,1),this.meshRegistry[t]=null},i.prototype.setCutoutUniform=function(t,e,n){var i=this.getOrSetCutout(t),o=i.uniformKeys.indexOf(e);if(n.length)for(var r=0,s=n.length;s>r;r++)i.uniformValues[o][r]=n[r];else i.uniformValues[o]=n},i.prototype.setMeshOptions=function(t,e){var n=this.meshRegistry[t]||this.createMesh(t);return n.options=e,this},i.prototype.setAmbientLightColor=function(t,e,n,i){return this.ambientLightColor[0]=e,this.ambientLightColor[1]=n,this.ambientLightColor[2]=i,this},i.prototype.setLightPosition=function(t,e,n,i){var o=this.lightRegistry[t]||this.createLight(t);return o.position[0]=e,o.position[1]=n,o.position[2]=i,this},i.prototype.setLightColor=function(t,e,n,i){var o=this.lightRegistry[t]||this.createLight(t);return o.color[0]=e,o.color[1]=n,o.color[2]=i,this},i.prototype.handleMaterialInput=function(t,e,n){var i=this.meshRegistry[t]||this.createMesh(t);n=u(n,i.textures.length),i.uniformValues[i.uniformKeys.indexOf(e)][0]=-n._id;for(var o=n.textures.length;o--;)i.textures.push(this.textureManager.register(n.textures[o],i.textures.length+o));return this.program.registerMaterial(e,n),this.updateSize()},i.prototype.setGeometry=function(t,e,n,i){var o=this.meshRegistry[t]||this.createMesh(t);return o.geometry=e,o.drawType=n,o.dynamic=i,this},i.prototype.setMeshUniform=function(t,e,n){var i=this.meshRegistry[t]||this.createMesh(t),o=i.uniformKeys.indexOf(e);-1===o?(i.uniformKeys.push(e),i.uniformValues.push(n)):i.uniformValues[o]=n},i.prototype.bufferData=function(t,e,n,i,o,r){return this.bufferRegistry.allocate(e,n,i,o,r),this},i.prototype.draw=function(t){var e=this.compositor.getTime();this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.textureManager.update(e),this.meshRegistryKeys=s(this.meshRegistryKeys,this.meshRegistry),this.setGlobalUniforms(t),this.drawCutouts(),this.drawMeshes()},i.prototype.drawMeshes=function(){for(var t,e,n=this.gl,i=0;i<this.meshRegistryKeys.length;i++)if(e=this.meshRegistry[this.meshRegistryKeys[i]],t=this.bufferRegistry.registry[e.geometry],e.visible&&(e.uniformValues[0]<1?(n.depthMask(!1),n.enable(n.BLEND)):(n.depthMask(!0),n.disable(n.BLEND)),t)){for(var o=e.textures.length;o--;)this.textureManager.bindTexture(e.textures[o]);e.options&&this.handleOptions(e.options,e),this.program.setUniforms(e.uniformKeys,e.uniformValues),this.drawBuffers(t,e.drawType,e.geometry),e.options&&this.resetOptions(e.options)}},i.prototype.drawCutouts=function(){var t,e,n=this.cutoutRegistryKeys.length;if(n){this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!0);for(var i=0;n>i;i++)t=this.cutoutRegistry[this.cutoutRegistryKeys[i]],e=this.bufferRegistry.registry[t.geometry],t.visible&&(this.program.setUniforms(t.uniformKeys,t.uniformValues),this.drawBuffers(e,t.drawType,t.geometry));this.gl.enable(this.gl.CULL_FACE)}},i.prototype.setGlobalUniforms=function(t){for(var e,n,i=0,o=this.lightRegistryKeys.length;o>i;i++)e=this.lightRegistry[this.lightRegistryKeys[i]],n=4*i,this.lightPositions[0+n]=e.position[0],this.lightPositions[1+n]=e.position[1],this.lightPositions[2+n]=e.position[2],this.lightColors[0+n]=e.color[0],this.lightColors[1+n]=e.color[1],this.lightColors[2+n]=e.color[2];p.values[0]=this.numLights,p.values[1]=this.ambientLightColor,p.values[2]=this.lightPositions,p.values[3]=this.lightColors,this.projectionTransform[0]=1/(.5*this.cachedSize[0]),this.projectionTransform[5]=-1/(.5*this.cachedSize[1]),this.projectionTransform[11]=t.perspectiveTransform[11],p.values[4]=this.projectionTransform,p.values[5]=.001*this.compositor.getTime(),p.values[6]=t.viewTransform,this.program.setUniforms(p.keys,p.values)},i.prototype.drawBuffers=function(t,e,n){var i,o,r,s,a,h,u,c,p=this.gl,l=0;for(h=t.keys.length,c=0;h>c;c++)i=t.keys[c],"indices"!==i?(o=this.program.attributeLocations[i],-1!==o&&(void 0!==o||(o=p.getAttribLocation(this.program.program,i),this.program.attributeLocations[i]=o,-1!==o))&&(this.state.enabledAttributes[i]||(p.enableVertexAttribArray(o),this.state.enabledAttributes[i]=!0,this.state.enabledAttributesKeys.push(i)),a=t.values[c],r=t.spacing[c],s=t.offset[c],l=t.length[c],this.state.boundArrayBuffer!==a&&(p.bindBuffer(a.target,a.buffer),this.state.boundArrayBuffer=a),this.state.lastDrawn!==n&&p.vertexAttribPointer(o,r,p.FLOAT,p.FALSE,0,4*s))):u=c;var f=this.state.enabledAttributesKeys.length;for(c=0;f>c;c++){var d=this.state.enabledAttributesKeys[c];this.state.enabledAttributes[d]&&-1===t.keys.indexOf(d)&&(p.disableVertexAttribArray(this.program.attributeLocations[d]),this.state.enabledAttributes[d]=!1)}l&&(void 0!==u?(a=t.values[u],s=t.offset[u],r=t.spacing[u],l=t.length[u],this.state.boundElementBuffer!==a&&(p.bindBuffer(a.target,a.buffer),this.state.boundElementBuffer=a),p.drawElements(p[e],l,p.UNSIGNED_SHORT,2*s)):p.drawArrays(p[e],0,l)),this.state.lastDrawn=n},i.prototype.updateSize=function(t){if(t){var e=window.devicePixelRatio||1,n=~~(t[0]*e),i=~~(t[1]*e);this.canvas.width=n,this.canvas.height=i,this.gl.viewport(0,0,n,i),this.cachedSize[0]=t[0],this.cachedSize[1]=t[1],this.cachedSize[2]=t[0]>t[1]?t[0]:t[1],this.resolutionValues[0]=this.cachedSize}return this.program.setUniforms(this.resolutionName,this.resolutionValues),this},i.prototype.handleOptions=function(t,e){var n=this.gl;t&&(t.blending&&n.enable(n.BLEND),"double"===t.side&&(this.gl.cullFace(this.gl.FRONT),this.drawBuffers(this.bufferRegistry.registry[e.geometry],e.drawType,e.geometry),this.gl.cullFace(this.gl.BACK)),"back"===t.side&&n.cullFace(n.FRONT))},i.prototype.resetOptions=function(t){var e=this.gl;t&&(t.blending&&e.disable(e.BLEND),"back"===t.side&&e.cullFace(e.BACK))},e.exports=i},{"../utilities/keyValueToArrays":42,"./BufferRegistry":45,"./Program":47,"./TextureManager":49,"./compileMaterial":51,"./radixSort":53}],51:[function(t,e,n){"use strict";function i(t,e){var n="",i={},u={},p={},l=[],f=[];return o(t,function(t,o){if(t.chunk){var d=c[r(t)],m=a(t),_=s(t.chunk.glsl,t.inputs,f.length+e);n+=d+m+" = "+_+"\n ",t.uniforms&&h(i,t.uniforms),t.varyings&&h(u,t.varyings),t.attributes&&h(p,t.attributes),t.chunk.defines&&l.push(t.chunk.defines),t.texture&&f.push(t.texture)}}),{_id:t._id,glsl:n+"return "+a(t)+";",defines:l.join("\n"),uniforms:i,varyings:u,attributes:p,textures:f}}function o(t,e){for(var n=t.inputs,i=n&&n.length,r=-1;++r<i;)o(n[r],e);return e(t),t}function r(t){if("number"==typeof t)return 1;if(Array.isArray(t))return t.length;var e=t.chunk.output;if("number"==typeof e)return e;var n=t.inputs.map(function(t){return r(t)}).join(",");return e[n]}function s(t,e,n){return t.replace(/%\d/g,function(t){return a(e[t[1]-1])}).replace(/\$TEXTURE/,"u_textures["+n+"]")}function a(t){return Array.isArray(t)?u(t):"object"==typeof t?"fa_"+t._id:t.toFixed(6)}function h(t,e){for(var n in e)t[n]=e[n]}function u(t){var e=t.length;return"vec"+e+"("+t.join(",")+")"}var c={1:"float ",2:"vec2 ",3:"vec3 ",4:"vec4 "};e.exports=i},{}],52:[function(t,e,n){"use strict";function i(){var t=document.createElement("canvas").getContext("2d");t.canvas.width=t.canvas.height=128;for(var e=0;e<t.canvas.height;e+=16)for(var n=0;n<t.canvas.width;n+=16)t.fillStyle=16&(n^e)?"#FFF":"#DDD",t.fillRect(n,e,16,16);return t.canvas}e.exports=i},{}],53:[function(t,e,n){"use strict";function i(t,e,n){var i=t[n],o=e[i];return(o.depth?o.depth:e[i].uniformValues[1][14])+g}function o(t,e,n,i){var o=t[n];return e[o].depth=a(i)-g,o}function r(t,e,n){e[t[n]].depth=null}function s(t){return v[0]=t,T[0]}function a(t){return T[0]=t,v[0]}function h(t,e){var n,a,h,f,g,y,v,T,E,b,R,S=0,C=[];for(m=32/u+.999999999999999|0,n=0,f=c*m;f>n;n++)l[n]=0;for(n=0,f=t.length;f>n;n++){for(g=s(i(t,e,n)),g^=g>>31|2147483648,a=0,h=0;_>a;a+=c,h+=u)l[a+(g>>>h&p)]++;l[a+(g>>>h&d)]++}for(a=0;_>=a;a+=c)for(T=a,E=0;a+c>T;T++)b=l[T]+E,l[T]=E-1,E=b;if(--m){for(n=0,f=t.length;f>n;n++)g=s(i(t,e,n)),C[++l[g&p]]=o(t,e,n,g^=g>>31|2147483648);for(v=C,C=t,t=v;++S<m;){for(n=0,f=t.length,y=S*c,R=S*u;f>n;n++)g=s(i(t,e,n)),C[++l[y+(g>>>R&p)]]=t[n];v=C,C=t,t=v}}for(n=0,f=t.length,y=S*c,R=S*u;f>n;n++)g=s(i(t,e,n)),C[++l[y+(g>>>R&d)]]=o(t,e,n,g^(~g>>31|2147483648)),r(t,e,n);return C}var u=11,c=1<<u,p=c-1,l=new Array(c*Math.ceil(64/u)),f=1<<31%u,d=(f<<1)-1,m=32/u+.999999999999999|0,_=c*(m-1),g=Math.pow(20,6),y=new ArrayBuffer(4),v=new Float32Array(y,0,1),T=new Int32Array(y,0,1);e.exports=h},{}],54:[function(t,e,n){"use strict";var i={vertex:'#define GLSLIFY 1\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * Calculates transpose inverse matrix from transform\n * \n * @method random\n * @private\n *\n *\n */\n\n\nmat3 getNormalMatrix_1_0(in mat4 t) {\n   mat3 matNorm;\n   mat4 a = t;\n\n   float a00 = a[0][0], a01 = a[0][1], a02 = a[0][2], a03 = a[0][3],\n   a10 = a[1][0], a11 = a[1][1], a12 = a[1][2], a13 = a[1][3],\n   a20 = a[2][0], a21 = a[2][1], a22 = a[2][2], a23 = a[2][3],\n   a30 = a[3][0], a31 = a[3][1], a32 = a[3][2], a33 = a[3][3],\n   b00 = a00 * a11 - a01 * a10,\n   b01 = a00 * a12 - a02 * a10,\n   b02 = a00 * a13 - a03 * a10,\n   b03 = a01 * a12 - a02 * a11,\n   b04 = a01 * a13 - a03 * a11,\n   b05 = a02 * a13 - a03 * a12,\n   b06 = a20 * a31 - a21 * a30,\n   b07 = a20 * a32 - a22 * a30,\n   b08 = a20 * a33 - a23 * a30,\n   b09 = a21 * a32 - a22 * a31,\n   b10 = a21 * a33 - a23 * a31,\n   b11 = a22 * a33 - a23 * a32,\n\n   det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n   det = 1.0 / det;\n\n   matNorm[0][0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n   matNorm[0][1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n   matNorm[0][2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n\n   matNorm[1][0] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n   matNorm[1][1] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n   matNorm[1][2] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n\n   matNorm[2][0] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n   matNorm[2][1] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n   matNorm[2][2] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n\n   return matNorm;\n}\n\n\n\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * Calculates a matrix that creates the identity when multiplied by m\n * \n * @method inverse\n * @private\n *\n *\n */\n\n\nfloat inverse_2_1(float m) {\n    return 1.0 / m;\n}\n\nmat2 inverse_2_1(mat2 m) {\n    return mat2(m[1][1],-m[0][1],\n               -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse_2_1(mat3 m) {\n    float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n    float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n    float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n    float b01 =  a22 * a11 - a12 * a21;\n    float b11 = -a22 * a10 + a12 * a20;\n    float b21 =  a21 * a10 - a11 * a20;\n\n    float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n    return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n                b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n                b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse_2_1(mat4 m) {\n    float\n        a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n        a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n        a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n        a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n        b00 = a00 * a11 - a01 * a10,\n        b01 = a00 * a12 - a02 * a10,\n        b02 = a00 * a13 - a03 * a10,\n        b03 = a01 * a12 - a02 * a11,\n        b04 = a01 * a13 - a03 * a11,\n        b05 = a02 * a13 - a03 * a12,\n        b06 = a20 * a31 - a21 * a30,\n        b07 = a20 * a32 - a22 * a30,\n        b08 = a20 * a33 - a23 * a30,\n        b09 = a21 * a32 - a22 * a31,\n        b10 = a21 * a33 - a23 * a31,\n        b11 = a22 * a33 - a23 * a32,\n\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    return mat4(\n        a11 * b11 - a12 * b10 + a13 * b09,\n        a02 * b10 - a01 * b11 - a03 * b09,\n        a31 * b05 - a32 * b04 + a33 * b03,\n        a22 * b04 - a21 * b05 - a23 * b03,\n        a12 * b08 - a10 * b11 - a13 * b07,\n        a00 * b11 - a02 * b08 + a03 * b07,\n        a32 * b02 - a30 * b05 - a33 * b01,\n        a20 * b05 - a22 * b02 + a23 * b01,\n        a10 * b10 - a11 * b08 + a13 * b06,\n        a01 * b08 - a00 * b10 - a03 * b06,\n        a30 * b04 - a31 * b02 + a33 * b00,\n        a21 * b02 - a20 * b04 - a23 * b00,\n        a11 * b07 - a10 * b09 - a12 * b06,\n        a00 * b09 - a01 * b07 + a02 * b06,\n        a31 * b01 - a30 * b03 - a32 * b00,\n        a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n\n\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * Reflects a matrix over its main diagonal.\n * \n * @method transpose\n * @private\n *\n *\n */\n\n\nfloat transpose_3_2(float m) {\n    return m;\n}\n\nmat2 transpose_3_2(mat2 m) {\n    return mat2(m[0][0], m[1][0],\n                m[0][1], m[1][1]);\n}\n\nmat3 transpose_3_2(mat3 m) {\n    return mat3(m[0][0], m[1][0], m[2][0],\n                m[0][1], m[1][1], m[2][1],\n                m[0][2], m[1][2], m[2][2]);\n}\n\nmat4 transpose_3_2(mat4 m) {\n    return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\n                m[0][1], m[1][1], m[2][1], m[3][1],\n                m[0][2], m[1][2], m[2][2], m[3][2],\n                m[0][3], m[1][3], m[2][3], m[3][3]);\n}\n\n\n\n\n/**\n * Converts vertex from modelspace to screenspace using transform\n * information from context.\n *\n * @method applyTransform\n * @private\n *\n *\n */\n\nvec4 applyTransform(vec4 pos) {\n    //TODO: move this multiplication to application code. \n\n    /**\n     * Currently multiplied in the vertex shader to avoid consuming the complexity of holding an additional\n     * transform as state on the mesh object in WebGLRenderer. Multiplies the object\'s transformation from object space\n     * to world space with its transformation from world space to eye space.\n     */\n    mat4 MVMatrix = u_view * u_transform;\n\n    //TODO: move the origin, sizeScale and y axis inversion to application code in order to amortize redundant per-vertex calculations.\n\n    /**\n     * The transform uniform should be changed to the result of the transformation chain:\n     *\n     * view * modelTransform * invertYAxis * sizeScale * origin\n     *\n     * which could be simplified to:\n     *\n     * view * modelTransform * convertToDOMSpace\n     *\n     * where convertToDOMSpace represents the transform matrix:\n     *\n     *                           size.x 0       0       size.x \n     *                           0      -size.y 0       size.y\n     *                           0      0       1       0\n     *                           0      0       0       1\n     *\n     */\n\n    /**\n     * Assuming a unit volume, moves the object space origin [0, 0, 0] to the "top left" [1, -1, 0], the DOM space origin.\n     * Later in the transformation chain, the projection transform negates the rigidbody translation.\n     * Equivalent to (but much faster than) multiplying a translation matrix "origin"\n     *\n     *                           1 0 0 1 \n     *                           0 1 0 -1\n     *                           0 0 1 0\n     *                           0 0 0 1\n     *\n     * in the transform chain: projection * view * modelTransform * invertYAxis * sizeScale * origin * positionVector.\n     */\n    pos.x += 1.0;\n    pos.y -= 1.0;\n\n    /**\n     * Assuming a unit volume, scales an object to the amount of pixels in the size uniform vector\'s specified dimensions.\n     * Later in the transformation chain, the projection transform transforms the point into clip space by scaling\n     * by the inverse of the canvas\' resolution.\n     * Equivalent to (but much faster than) multiplying a scale matrix "sizeScale"\n     *\n     *                           size.x 0      0      0 \n     *                           0      size.y 0      0\n     *                           0      0      size.z 0\n     *                           0      0      0      1\n     *\n     * in the transform chain: projection * view * modelTransform * invertYAxis * sizeScale * origin * positionVector.\n     */\n    pos.xyz *= u_size * 0.5;\n\n    /**\n     * Inverts the object space\'s y axis in order to match DOM space conventions. \n     * Later in the transformation chain, the projection transform reinverts the y axis to convert to clip space.\n     * Equivalent to (but much faster than) multiplying a scale matrix "invertYAxis"\n     *\n     *                           1 0 0 0 \n     *                           0 -1 0 0\n     *                           0 0 1 0\n     *                           0 0 0 1\n     *\n     * in the transform chain: projection * view * modelTransform * invertYAxis * sizeScale * origin * positionVector.\n     */\n    pos.y *= -1.0;\n\n    /**\n     * Exporting the vertex\'s position as a varying, in DOM space, to be used for lighting calculations. This has to be in DOM space\n     * since light position and direction is derived from the scene graph, calculated in DOM space.\n     */\n\n    v_position = (MVMatrix * pos).xyz;\n\n    /**\n    * Exporting the eye vector (a vector from the center of the screen) as a varying, to be used for lighting calculations.\n    * In clip space deriving the eye vector is a matter of simply taking the inverse of the position, as the position is a vector\n    * from the center of the screen. However, since our points are represented in DOM space,\n    * the position is a vector from the top left corner of the screen, so some additional math is needed (specifically, subtracting\n    * the position from the center of the screen, i.e. half the resolution of the canvas).\n    */\n\n    v_eyeVector = (u_resolution * 0.5) - v_position;\n\n    /**\n     * Transforming the position (currently represented in dom space) into view space (with our dom space view transform)\n     * and then projecting the point into raster both by applying a perspective transformation and converting to clip space\n     * (the perspective matrix is a combination of both transformations, therefore it\'s probably more apt to refer to it as a\n     * projection transform).\n     */\n\n    pos = u_perspective * MVMatrix * pos;\n\n    return pos;\n}\n\n/**\n * Placeholder for positionOffset chunks to be templated in.\n * Used for mesh deformation.\n *\n * @method calculateOffset\n * @private\n *\n *\n */\n#vert_definitions\nvec3 calculateOffset(vec3 ID) {\n    #vert_applications\n    return vec3(0.0);\n}\n\n/**\n * Writes the position of the vertex onto the screen.\n * Passes texture coordinate and normal attributes as varyings\n * and passes the position attribute through position pipeline.\n *\n * @method main\n * @private\n *\n *\n */\nvoid main() {\n    v_textureCoordinate = a_texCoord;\n    vec3 invertedNormals = a_normals + (u_normals.x < 0.0 ? calculateOffset(u_normals) * 2.0 - 1.0 : vec3(0.0));\n    invertedNormals.y *= -1.0;\n    v_normal = transpose_3_2(mat3(inverse_2_1(u_transform))) * invertedNormals;\n    vec3 offsetPos = a_pos + calculateOffset(u_positionOffset);\n    gl_Position = applyTransform(vec4(offsetPos, 1.0));\n}\n',
fragment:'#define GLSLIFY 1\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * Placeholder for fragmentShader  chunks to be templated in.\n * Used for normal mapping, gloss mapping and colors.\n * \n * @method applyMaterial\n * @private\n *\n *\n */\n\n#float_definitions\nfloat applyMaterial_1_0(float ID) {\n    #float_applications\n    return 1.;\n}\n\n#vec3_definitions\nvec3 applyMaterial_1_0(vec3 ID) {\n    #vec3_applications\n    return vec3(0);\n}\n\n#vec4_definitions\nvec4 applyMaterial_1_0(vec4 ID) {\n    #vec4_applications\n\n    return vec4(0);\n}\n\n\n\n/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2015 Famous Industries Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * Calculates the intensity of light on a surface.\n *\n * @method applyLight\n * @private\n *\n */\nvec4 applyLight_2_1(in vec4 baseColor, in vec3 normal, in vec4 glossiness, int numLights, vec3 ambientColor, vec3 eyeVector, mat4 lightPosition, mat4 lightColor, vec3 v_position) {\n    vec3 diffuse = vec3(0.0);\n    bool hasGlossiness = glossiness.a > 0.0;\n    bool hasSpecularColor = length(glossiness.rgb) > 0.0;\n\n    for(int i = 0; i < 4; i++) {\n        if (i >= numLights) break;\n        vec3 lightDirection = normalize(lightPosition[i].xyz - v_position);\n        float lambertian = max(dot(lightDirection, normal), 0.0);\n\n        if (lambertian > 0.0) {\n            diffuse += lightColor[i].rgb * baseColor.rgb * lambertian;\n            if (hasGlossiness) {\n                vec3 halfVector = normalize(lightDirection + eyeVector);\n                float specularWeight = pow(max(dot(halfVector, normal), 0.0), glossiness.a);\n                vec3 specularColor = hasSpecularColor ? glossiness.rgb : lightColor[i].rgb;\n                diffuse += specularColor * specularWeight * lambertian;\n            }\n        }\n\n    }\n\n    return vec4(ambientColor + diffuse, baseColor.a);\n}\n\n\n\n\n\n/**\n * Writes the color of the pixel onto the screen\n *\n * @method main\n * @private\n *\n *\n */\nvoid main() {\n    vec4 material = u_baseColor.r >= 0.0 ? u_baseColor : applyMaterial_1_0(u_baseColor);\n\n    /**\n     * Apply lights only if flat shading is false\n     * and at least one light is added to the scene\n     */\n    bool lightsEnabled = (u_flatShading == 0.0) && (u_numLights > 0.0 || length(u_ambientLight) > 0.0);\n\n    vec3 normal = normalize(v_normal);\n    vec4 glossiness = u_glossiness.x < 0.0 ? applyMaterial_1_0(u_glossiness) : u_glossiness;\n\n    vec4 color = lightsEnabled ?\n    applyLight_2_1(material, normalize(v_normal), glossiness,\n               int(u_numLights),\n               u_ambientLight * u_baseColor.rgb,\n               normalize(v_eyeVector),\n               u_lightPosition,\n               u_lightColor,   \n               v_position)\n    : material;\n\n    gl_FragColor = color;\n    gl_FragColor.a *= u_opacity;   \n}\n'};e.exports=i},{}],55:[function(t,e,n){"use strict";var i=t("famous/dom-renderables/DOMElement"),o=t("famous/core/FamousEngine"),r=t("famous/transitions/Transitionable");o.init();var s=o.createScene(),a=s.addChild();new i(a,{content:'Radio "OSA"'}).setAttribute("style","background-color:grey;font-size:2em;text-align:center;color:white"),a.setSizeMode("absolute","absolute","absolute").setAbsoluteSize(250,250).setAlign(.5,.5).setMountPoint(.5,.5).setOrigin(.5,.5),a.addUIEvent("click");var h=new r(0),u=a.addComponent({onUpdate:function(){a.setRotation(0,h.get(),0),a.requestUpdateOnNextTick(u)}}),c=a.addChild();c.setSizeMode("absolute","absolute","absolute").setAbsoluteSize(200,200).setAlign(.5,.5).setMountPoint(.5,.5).setOrigin(.5,.5),new i(c,{content:"Radio Program"}).setAttribute("style","background-color:red;font-size:2em;text-align:center;color:white"),c.setOpacity(0),c.setRotation(0,Math.PI,0),a.onReceive=function(t){a.requestUpdate(u);var e=0===h.get()?Math.PI:0;h.set(e,{duration:1e3},function(){c.setOpacity(1,{duration:2e3})})}},{"famous/core/FamousEngine":7,"famous/dom-renderables/DOMElement":16,"famous/transitions/Transitionable":39}]},{},[55]);
